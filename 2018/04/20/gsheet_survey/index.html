<!doctype html><html><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="About Learning"><link rel=stylesheet href=/css/style.css><link rel=stylesheet href=/css/fonts.css><link rel=stylesheet href=/css/custom.css><title>google 表單即時回饋 |
Yongfu's Blog</title></head><body><div class=header><div class=header_title><span class=logo><!doctype html><svg version="1.0" xmlns="http://www.w3.org/2000/svg" width="346pt" height="346pt" viewBox="0 0 346 346"><g transform="translate(0.000000,346.000000) scale(0.100000,-0.100000)" fill="#000" stroke="none"><path d="M1484 3328c8-40 19-53 84-94 36-24 52-40 50-52-2-10-12-16-23-15-173 21-208 16-293-38-17-12-66-30-108-40-117-29-354-149-354-178 0-5 20-6 45-3 28 3 45 1 45-6 0-6-32-32-70-57-98-65-105-78-90-162 7-38 20-88 30-113 21-50 17-65-33-117-23-25-32-46-38-93-7-49-17-70-50-112-39-50-41-55-33-98 4-25 8-95 8-156 1-104 3-113 29-151 15-22 41-52 58-67 16-14 29-33 29-41 0-33 71-189 122-267 30-46 82-113 116-149 56-60 60-67 47-85-27-39-155-291-155-305 1-8 45-43 99-79l97-64-7-47c-4-25-22-73-40-104-33-59-38-93-31-205 2-43-13-179-23-202-4-10-10-16-14-14-16 10-39-21-34-47 5-23 9-26 32-20 41 12 94 9 98-4 7-21-131-17-152 3-12 13-19 14-30 4-8-7-15-19-15-26 0-12 68-14 405-14 263 0 405 3 405 10 0 6-83 10-230 10h-230l-11 27c-7 20-6 28 3 35 24 15 136 8 272-17 167-31 201-31 351 0 123 25 190 30 283 18 47-5 53-8 50-27-3-21-8-21-235-24-198-2-233-5-233-17 0-13 54-15 409-15 406 0 409 0 404 20-7 27-43 48-43 25 0-22-34-19-56 6-15 17-16 22-4 29 9 6 17 5 22-3 4-6 10-8 14-4s-1 16-11 27c-14 16-21 18-28 8-6-9-7-8-3 5 3 10 0 20-9 23-7 3-11 12-8 20s0 21-7 29c-20 24-30 87-17 103 6 8 11 44 11 82-1 53-8 82-32 136-28 60-58 163-50 168 2 1 41 19 88 40s89 42 94 46c17 17-80 244-135 314l-20 25-44-30c-48-32-188-1e2-245-118-19-6-83-27-142-46-116-39-236-53-303-37-39 10-38 10 27 11 37 1 102 7 145 13l78 13-140 6c-209 10-363 60-526 169-192 130-358 370-403 587l-7 31 78 7c43 3 90 8 104 11l26 5 17-148c11-91 23-157 33-172 15-24 16-24 147-18 203 9 528 54 544 75 11 13 13 54 10 179-4 165-3 173 33 173 5 0 9-30 9-67 0-87 18-240 30-263 16-29 99-34 392-23 222 8 270 12 292 26l26 17v160 160h28c16 0 63 3 104 6l75 7 7-42c6-40 3-47-49-122-31-43-51-79-45-79s37 13 69 30c64 32 73 47 87 140 9 63 36 112 84 152 45 39 49 52 20 68-11 6-38 35-61 66-39 51-42 60-50 144-5 49-15 106-24 126-14 35-14 39 4 58 27 29 35 69 21 110-8 26-24 42-63 64-58 33-81 55-95 93-15 37 17 103 63 130 19 12 35 25 35 30 0 17-68 9-147-16-42-13-79-22-81-20-12 11 33 56 80 82l52 28-34 3c-22 2-52-6-92-27-32-17-65-31-73-31-25 0-108 46-155 85-57 48-142 85-192 85-46 0-57 5-163 76-81 54-192 94-262 94-21 0-54 15-99 45-36 25-69 45-72 45-2 0-2-14 2-32zm-143-641c-13-16-43-98-38-104 2-2 20 11 40 29s56 44 79 56l43 24-48-48c-31-30-64-79-94-138l-45-91 59 61c45 48 84 75 178 124 66 34 130 70 143 79 32 23 183 11 261-21 50-20 72-23 204-23 143 0 149 1 166 23l17 24 19-44c23-51 167-203 279-295 48-39 81-73 82-86 2-12 12-62 22-112 11-49 18-91 17-93-4-4-199 50-208 58-4 4-9 45-11 91l-3 84-83-1c-82-1-83-1-112 32-42 48-124 84-191 84-49 0-66-7-186-76-90-52-130-81-127-90 4-10-2-14-19-14-24 0-24-2-27-92-3-87-4-93-25-96-20-3-22 2-28 75-3 43-8 83-10 90-3 9-79 10-307 6-167-3-334-8-373-12-80-7-75 2-61-121l7-66-93-38c-51-21-99-41-107-44-12-4-13 5-8 49 4 30 14 76 23 102 14 42 23 51 68 74 30 15 88 63 142 117 70 71 106 118 162 212 58 1e2 82 130 134 172 65 53 78 62 59 39zm897-336c20-10 48-30 61-44l23-25-43-7c-71-9-389-41-389-39 0 7 120 94 155 112 53 28 142 29 193 3zm216-399c4-152 4-285 1-294-4-9-14-19-23-23s-143-9-298-12c-248-5-281-4-287 10-7 18-24 241-31 413l-6 122 113 12c61 6 184 20 272 30 88 9 181 18 206 19l46 1 7-278zm-810 171c16-80 37-505 26-516-17-16-580-71-593-58-5 5-10 28-13 52-2 31-1 37 4 19 5-16 17-26 32-28 23-4 421 34 469 44 13 3 21 7 18 10-2 3-114-7-247-21-134-14-247-22-251-18-10 11-53 448-45 468 5 13 42 15 265 15 181 0 262 3 267 11s-65 10-260 7c-217-3-268-6-280-18-12-13-13-33-1-150 8-74 14-151 13-170-1-40-23 141-34 277l-7 93 169 3c93 1 235 4 316 5l146 2 6-27zm-587-455c-2-13-4-3-4 22s2 35 4 23c2-13 2-33 0-45zM975 191c3-5 1-12-5-16-5-3-10 1-10 9 0 18 6 21 15 7zm210-59c-9-9-25 19-24 43 0 16 2 15 15-8 9-16 13-32 9-35zm-55 9c0-11-4-9-14 4-8 11-12 24-9 28 7 11 23-12 23-32zm1108 17c-2-6-10-14-16-16-7-2-10 2-6 12 7 18 28 22 22 4zm44-10c-7-7-12-8-12-2 0 14 12 26 19 19 2-3-1-11-7-17zm83 2c4-6-5-10-20-10s-24 4-20 10c3 6 12 10 20 10s17-4 20-10z"/><path d="M1260 2374c-42-23-1e2-75-1e2-89 0-4 16 7 35 24 56 49 95 65 155 65 66 0 115-23 214-1e2 71-57 90-63 121-40 16 12 6 20-116 90-131 74-137 76-199 75-49 0-76-7-110-25z"/><path d="M2070 2158c-102-11-189-25-195-30-7-7 2-9 30-4 104 16 474 48 489 43 15-6 16-32 14-244l-3-238-247-3c-141-1-248-6-248-11 0-9 469-4 498 5 10 3 12 58 10 251l-3 248-80 2c-44 0-163-8-265-19z"/><path d="M1969 1961c-62-62-20-171 66-171 27 0 44 8 66 29 62 62 20 171-66 171-27 0-44-8-66-29z"/><path d="M1414 1940c-60-24-73-112-25-161 39-38 87-39 130-3 26 22 31 33 31 71 0 77-65 122-136 93z"/><path d="M1512 1343c2-10 32-33 67-52 91-48 176-54 255-18 52 24 77 49 62 64-3 3-29-6-57-21-76-42-149-39-243 8-81 41-89 43-84 19z"/><path d="M933 693c15-2 39-2 55 0 15 2 2 4-28 4s-43-2-27-4z"/><path d="M2388 673c6-2 18-2 25 0 6 3 1 5-13 5s-19-2-12-5z"/><path d="M870 155c-6-8-10-19-8-24 1-6 8 1 15 14 13 28 11 31-7 10z"/><path d="M2546 157c3-10 9-15 12-12s0 11-7 18c-10 9-11 8-5-6z"/></g></svg></span><span>Yongfu's Blog</span></div><div class=site_nav><span class=nav_link><a href=/>Home</a></span>
<span class=nav_link><a href=/post/>Posts</a></span>
<span class=nav_link><a href=/about/>About</a></span>
<span class=nav_link><a href=/feed.xml>Subscribe</a></span></div></div><div class=main><article class=post><div class=article_header><div class=titles><h1>google 表單即時回饋</h1></div><div class=meta><div class=tags><a href="/post/?tag=web-page">web page</a>
<a href="/post/?tag=%25E4%25B8%25AD%25E6%2596%2587">中文</a></div><div class=date><span class=inline-icon><svg aria-hidden="true" focusable="false" data-prefix="far" data-icon="calendar-alt" class="svg-inline--fa fa-calendar-alt fa-w-14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><path fill="rgb(95, 95, 95)" d="M148 288h-40c-6.6.0-12-5.4-12-12v-40c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v40c0 6.6-5.4 12-12 12zm108-12v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 96v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm-96 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm192 0v-40c0-6.6-5.4-12-12-12h-40c-6.6.0-12 5.4-12 12v40c0 6.6 5.4 12 12 12h40c6.6.0 12-5.4 12-12zm96-260v352c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h48V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h128V12c0-6.6 5.4-12 12-12h40c6.6.0 12 5.4 12 12v52h48c26.5.0 48 21.5 48 48zm-48 346V160H48v298c0 3.3 2.7 6 6 6h340c3.3.0 6-2.7 6-6z"/></svg></span><span class=str>Apr 20, 2018</span></div></div></div><div class=article_content><style>pre>code{white-space:pre-wrap}</style><p>google 表單大幅降低蒐集問卷資料的難度；此外，表單將回應<strong>自動彙整成試算表</strong>更使分析資料變得非常容易。然而，google 表單缺乏一項重要的功能：<strong>即時將結果回饋給填寫者</strong><sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup>。</p><p>讓問卷填寫者能馬上知道結果，可以增加其填寫意願，同時也是負責的態度(在回饋不會造成負面影響的前提下)。當然，這在 google 表單本身的限制下無法達成。以下將介紹如何結合 <strong>google 試算表</strong> 以及 <strong><a href=https://github.com/datacamp/datacamp-light>DataCamp Light</a></strong>，讓任何人都能製作出一個在<strong>靜態網頁</strong>上運行的平台，<strong>使填寫者能在此填寫問卷、查詢結果</strong>。</p><h2 id=實際操作>實際操作</h2><p>繼續閱讀下去前，可先至<a href=https://img.yongfu.name/assets/gsheet_post/demo/>回饋功能示範平台</a>操作看看，比較容易理解下文內容。文章中的說明即是依據此<strong>回饋功能示範平台</strong>。</p><h2 id=概觀-運作邏輯>概觀: 運作邏輯</h2><img src=https://img.yongfu.name/assets/images/post_img/gsheet_mermaid.png alt=運作邏輯 style=width:32em><p>上圖的每個方塊(除了左圖的<strong>試算表</strong>)名稱，皆對應到<strong>回饋功能示範平台</strong>背後運作的檔案。圖需要分<strong>左</strong>、<strong>右</strong>來看：</p><ul><li><p><strong>左側</strong>以使用者觀點為中心，顯示使用者填寫問卷(送出資料)到獲得回饋之間，資料流動的路程。</p></li><li><p><strong>右側</strong>的流程圖，實際上是左圖<strong>試算表</strong>(表單、DataCamp之間)那格的完整路程，意即資料在 google 試算表間的流動及運算。使用者獲得的回饋即是由這些試算表的運算產生。</p></li></ul><p><strong>回饋功能</strong>運作的邏輯其實非常簡單：在問卷送出後，透過 <strong>google 試算表</strong>處理資料(運算、整理)；接著透過 <strong>DataCamp light</strong> 執行預先寫入的 R 語言，讀取經 <strong>google 試算表</strong>處理後的資料；最後使用者輸入查詢金鑰(於問卷中填寫)，篩選出那筆自己填寫的資料。</p><p>以下，說明如何設置問卷回饋系統的各個成分，並使用此<a href="https://drive.google.com/open?id=16lRn7UUo_-8OUdfaYrg7CSUNIvOAmAM8">資料夾</a>中的檔案說明。檔案間的關係完全對應至上文<strong>概觀</strong>中的<a href=#mermaidChart0>概念圖</a>，亦即<strong>問卷回饋平台</strong>背後蒐集及運算資料所使用到的檔案。下方的說明，單純閱讀文字會難以理解。若有打算實作，可實際打開資料夾中的檔案以配合閱讀，或甚至完全自己重複文中的步驟。</p><h2 id=表單試算表-設置>表單、試算表 設置</h2><p>這節將設置<strong>問卷回饋平台</strong>的<strong>資料蒐集與運算功能</strong>，包含 1 個 google 表單(<code>表單</code>)及 3 個 google 試算表(<code>表單回應</code>, <code>運算分析</code>, <code>結果查找</code>)。</p><h3 id=連結表單至試算表>連結表單至試算表</h3><p>這項功能使用過 google 表單的人都知道，可參考 <a href="https://support.google.com/docs/answer/2917686?hl=zh-Hant">google 說明</a>，以下簡單說明：</p><p>從雲端硬碟進入到表單後，即會顯示下圖的頁面(需具編輯權限)。注意需於<strong>中間白色方塊</strong>點選「<strong>回覆</strong>」，畫面才會如下圖(預設畫面是「問題」)。</p><p><img src=https://img.yongfu.name/assets/gsheet_post/linksheet.PNG alt></p><p>接著點選白色方塊右上方的綠色 icon，即會出現 2 個選項：</p><ul><li>建立新試算表，並命名。 (預設名稱為「無標題表單 (回應)」)</li><li>選取現有的試算表</li></ul><p>選擇建立新的試算表。<br>點選建立後，即會在與表單相同的資料夾中建立試算表，我將其命名為<strong>表單回應</strong>(即<strong>概觀</strong>中<a href=#mermaidChart0>右圖</a>的<code>表單回應</code>)。<br>此後，每當有人填完問卷，<code>表單回應</code>即會自動新增一列(row)資料。</p><h3 id=試算表間的連結-importrange>試算表間的連結: <code>IMPORTRANGE</code></h3><p><strong>千萬不能編輯<code>表單回應</code></strong>，這可能會破壞收集到的問卷資料。google 試算表有一個很實用的函數<code>IMPORTRANGE</code>，能夠選取一試算表中特定的範圍，將其連結至另一獨立的試算表中(獨立檔案)。因此，每當原先的試算表更新，透過<code>IMPORTRANGE</code>連結的新試算表也會跟著更新。如此，即可在不更動<code>表單回應</code>下，對<code>表單回應</code>的內容進行運算。</p><p>若此文關於<code>IMPORTRANGE</code>有描述不清的地方，可參考<a href=http://isvincent.pixnet.net/blog/post/46090834-excel-google%E8%A9%A6%E7%AE%97%E8%A1%A8%E5%A6%82%E4%BD%95%E9%97%9C%E8%81%AF%E5%88%B0%E5%8F%A6%E4%B8%80%E5%80%8B%E8%A9%A6%E7%AE%97%E8%A1%A8%E7%9A%84%E5%85%A7>這篇</a>寫得相當清楚的文章。
{: .info}</p><pre tabindex=0><code class=language-vbscript data-lang=vbscript>IMPORTRANGE(&#34;&lt;URL&gt;&#34;, &#34;&lt;工作表名稱&gt;!&lt;儲存格範圍&gt;&#34;)
</code></pre><ul><li><code>&lt;URL></code>: 所欲匯入資料之試算表的網址，在此為<code>表單回應</code>之URL</li><li><code>&lt;工作表名稱></code>: <code>表單回應</code>只有一個工作表，將其名稱填入這裡。</li><li><code>&lt;儲存格範圍></code>: 儲存格範圍視問卷的題數與筆數而定，其格式為：<code>A1:F9999</code>。大寫字母代表欄位，一個欄位即為問卷上的一題；字母後面的數字是列數，一筆資料(一份問卷)佔有一列(row)。</li></ul><h3 id=運算分析試算表>**<code>運算分析</code>**試算表</h3><h4 id=匯入>匯入</h4><p>在<a href="https://docs.google.com/spreadsheets/d/1znFpdD_Kt1Jk274l0yD1dGZZyhsh7m1Xji9IYZUigEU/edit#gid=0"><code>運算分析</code></a>中的儲存格<code>A1</code>，我輸入了以下公式：</p><pre tabindex=0><code class=language-vbscript data-lang=vbscript>=IMPORTRANGE(&#34;https://docs.google.com/spreadsheets/d/1-eOAbpOZ1aeuNUHo3b0olLTrheq-T-pe2BsRXK-P-mM/edit#gid=579070166&#34;, &#34;表單回應 1!A1:E9999&#34;)
</code></pre><p>以匯入<a href="https://docs.google.com/spreadsheets/d/1-eOAbpOZ1aeuNUHo3b0olLTrheq-T-pe2BsRXK-P-mM/edit#gid=579070166"><code>表單回應</code></a>的 A 至 E 欄<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>。</p><h4 id=運算公式>運算公式</h4><p>我在 G 欄設定公式計算 Q1, Q2, Q3 的分數總合，其中 <strong>Q3 是反向計分</strong>。</p><h4 id=時間戳記>時間戳記</h4><p>由於之後會透過 DataCamp Light 讀取 google 試算表，但其並不支援<strong>英文以外的文字</strong>，因此需<strong>將試算表的格式改為英文</strong>：</p><p>選擇試算表 <code>檔案</code> > <code>試算表設定</code> > <code>一般</code>:</p><ul><li>語言代碼: <code>美國</code></li><li>時區: <code>(GMT+08:00) Taipei</code><sup id=fnref:3><a href=#fn:3 class=footnote-ref role=doc-noteref>3</a></sup></li></ul><p>更改完試算表語言後，需更改<strong>時間戳記</strong>的格式<sup id=fnref:4><a href=#fn:4 class=footnote-ref role=doc-noteref>4</a></sup>：</p><ol><li>選擇時間戳記那欄(在此為 A 欄)</li><li><code>格式</code> > <code>數值</code> > <code>日期時間</code></li></ol><h3 id=結果查找試算表>**<code>結果查找</code>**試算表</h3><p><code>運算分析</code>設置完成之後，需要<strong>選擇希望使用者查詢時，能看到的項目</strong>:</p><ol><li><strong>時間戳記</strong>: A 欄</li><li><strong>Token</strong>: E 欄</li><li><strong>score</strong>: G 欄</li></ol><p>因此，需將<code>結果查找</code>中的 A、B、C 欄分別對應到<code>運算分析</code>中的 A、E、G 欄。在<code>結果查找</code>的儲存格<code>A1</code>、<code>B1</code>、<code>C1</code>，分別使用<code>IMPORTRANGE</code>：</p><ol><li>儲存格<code>A1</code></li></ol><pre tabindex=0><code class=language-vbscript data-lang=vbscript>=IMPORTRANGE(&#34;https://docs.google.com/spreadsheets/d/1znFpdD_Kt1Jk274l0yD1dGZZyhsh7m1Xji9IYZUigEU/edit#gid=0&#34;, &#34;工作表1!A1:A9999&#34;)
</code></pre><ol start=2><li>儲存格<code>B1</code></li></ol><pre tabindex=0><code class=language-vbscript data-lang=vbscript>=IMPORTRANGE(&#34;https://docs.google.com/spreadsheets/d/1znFpdD_Kt1Jk274l0yD1dGZZyhsh7m1Xji9IYZUigEU/edit#gid=0&#34;, &#34;工作表1!E1:E9999&#34;)
</code></pre><ol start=3><li>儲存格<code>C1</code></li></ol><pre tabindex=0><code class=language-vbscript data-lang=vbscript>=IMPORTRANGE(&#34;https://docs.google.com/spreadsheets/d/1znFpdD_Kt1Jk274l0yD1dGZZyhsh7m1Xji9IYZUigEU/edit#gid=0&#34;, &#34;工作表1!G1:G9999&#34;)
</code></pre><h2 id=datacamp-light-設置>DataCamp Light 設置</h2><p><a href=https://www.datacamp.com/>DataCamp</a> 是一個學習資料科學程式語言的線上教學網站，有 R 和 Python 的教學。<a href=https://github.com/datacamp/datacamp-light>DataCamp Light</a> 是一個互動式的程式語言輔助教學工具。其能夠鑲嵌在網頁上，讓使用者直接透過網頁學習 R 或 Python。</p><p><img src=https://img.yongfu.name/assets/gsheet_post/DataCamp.PNG alt></p><p>這裡即透過 DataCamp 執行預先寫入的 R Script，讀取儲存在雲端的<code>結果查找</code>。使用者在 DataCamp Light 輸入的<code>Token</code>是用來篩選資料，以回傳使用者填寫的那筆問卷。</p><h3 id=取得試算表權限>取得試算表權限</h3><p>DataCamp Light 讀取的是<code>結果查找</code>的內容，因此需將<code>結果查找</code>需將<code>結果查找</code>透過連結<strong>分享</strong><sup id=fnref:5><a href=#fn:5 class=footnote-ref role=doc-noteref>5</a></sup>至網路:</p><p>開啟<code>結果查找</code>，選取右上角藍色按鍵<strong>共用</strong>即會開啟下圖中的小視窗：</p><p><img src=https://img.yongfu.name/assets/gsheet_post/release_csv.PNG alt></p><p>接著，</p><ol><li>選取「知道連結的人均<strong>可以檢視</strong>」(注意<strong>不要選到可以編輯</strong>)</li><li>複製連結</li><li>按下方「完成」</li></ol><h3 id=完整程式碼>完整程式碼</h3><p>以下是<a href=https://img.yongfu.name/assets/gsheet_post/demo/>回饋功能示範平台</a>的 DataCamp Light 程式碼(html)：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-xml data-lang=xml><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#f92672>&lt;script</span> <span style=color:#a6e22e>src=</span><span style=color:#e6db74>&#34;https://cdn.datacamp.com/datacamp-light-latest.min.js&#34;</span><span style=color:#f92672>&gt;&lt;/script&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span><span style=color:#f92672>&lt;div</span> <span style=color:#960050;background-color:#1e0010>data-datacamp-exercise</span> <span style=color:#a6e22e>data-lang=</span><span style=color:#e6db74>&#34;r&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>  <span style=color:#f92672>&lt;code</span> <span style=color:#a6e22e>data-type=</span><span style=color:#e6db74>&#34;pre-exercise-code&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>    library(googlesheets)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span>    data <span style=color:#f92672>&lt;-</span> <span style=color:#960050;background-color:#1e0010>gs_read(gs_url(&#34;https://docs.google.com/spreadsheets/d/1ufuzTL9VCxdvX1QeFQcMGxYbEMq1ZEWVht3CEDpXBmc/edit?</span><span style=color:#a6e22e>usp=</span><span style=color:#e6db74>sharing&#34;))</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>              
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>    <span style=color:#960050;background-color:#1e0010>data</span> <span style=color:#960050;background-color:#1e0010>&lt;-</span> <span style=color:#960050;background-color:#1e0010>as.data.frame(data)</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>    <span style=color:#960050;background-color:#1e0010>colnames(data)</span> <span style=color:#960050;background-color:#1e0010>&lt;-</span> <span style=color:#960050;background-color:#1e0010>c(&#34;DateTime&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;Token&#34;,</span> <span style=color:#960050;background-color:#1e0010>&#34;Score&#34;)</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>    <span style=color:#960050;background-color:#1e0010>data</span> <span style=color:#960050;background-color:#1e0010>&lt;-</span> <span style=color:#960050;background-color:#1e0010>data[which(!is.na(data$DateTime)),]</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>    <span style=color:#960050;background-color:#1e0010>score</span> <span style=color:#960050;background-color:#1e0010>&lt;-</span> <span style=color:#960050;background-color:#1e0010>function(token)</span> <span style=color:#960050;background-color:#1e0010>{</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>      <span style=color:#960050;background-color:#1e0010>i</span> <span style=color:#960050;background-color:#1e0010>&lt;-</span> <span style=color:#960050;background-color:#1e0010>which(data$</span><span style=color:#a6e22e>Token =</span><span style=color:#e6db74>=</span> <span style=color:#960050;background-color:#1e0010>token)</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">12</span><span>      <span style=color:#960050;background-color:#1e0010>data[i,]</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">13</span><span>    <span style=color:#960050;background-color:#1e0010>}</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">14</span><span>  <span style=color:#960050;background-color:#1e0010>&lt;/code</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">15</span><span>  <span style=color:#f92672>&lt;code</span> <span style=color:#a6e22e>data-type=</span><span style=color:#e6db74>&#34;sample-code&#34;</span><span style=color:#f92672>&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">16</span><span>    # Put Token in &#34;&#34;. Ex: score(&#34;abcde123&#34;)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">17</span><span>    score(&#34;Enter_your_Token&#34;)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">18</span><span>  <span style=color:#f92672>&lt;/code&gt;</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">19</span><span><span style=color:#f92672>&lt;/div&gt;</span>
</span></span></code></pre></div><p>下面將分別說明這些程式碼的意義。</p><p><strong>注意</strong><br>DataCamp Light <strong>僅能正常顯示英文</strong>，因此需確定 R Script 以及使用者填入的 Token 皆沒有多位元組字(例如，中文)。
{: .error}</p><h3 id=預先執行程式碼>預先執行程式碼</h3><p>下面為<code>&lt;code data-type="pre-exercise-code">...&lt;/code></code>之間的程式碼<br>此段程式碼是使用者看不到，但會預先執行的 R Script，其中可分成 3 個部分：<strong>讀取資料</strong>、<strong>資料刪減</strong>、<strong>查找函數</strong>。</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 1</span><span><span style=color:#a6e22e>library</span>(googlesheets)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 2</span><span>data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>gs_read</span>(<span style=color:#a6e22e>gs_url</span>(<span style=color:#e6db74>&#34;https://docs.google.com/spreadsheets/d/1ufuzTL9VCxdvX1QeFQcMGxYbEMq1ZEWVht3CEDpXBmc/edit?usp=sharing&#34;</span>))
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 3</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 4</span><span>data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.data.frame</span>(data)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 5</span><span><span style=color:#a6e22e>colnames</span>(data) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;DateTime&#34;</span>, <span style=color:#e6db74>&#34;Token&#34;</span>, <span style=color:#e6db74>&#34;Score&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 6</span><span>data <span style=color:#f92672>&lt;-</span> data<span style=color:#a6e22e>[which</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>is.na</span>(data<span style=color:#f92672>$</span>DateTime)),]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 7</span><span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 8</span><span>score <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>function</span>(token) {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f"> 9</span><span>  i <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>which</span>(data<span style=color:#f92672>$</span>Token <span style=color:#f92672>==</span> token)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">10</span><span>  data[i,]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">11</span><span>}
</span></span></code></pre></div><h4 id=讀取資料>讀取資料</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#a6e22e>library</span>(googlesheets)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>gs_read</span>(<span style=color:#a6e22e>gs_url</span>(<span style=color:#e6db74>&#34;https://docs.google.com/spreadsheets/...&#34;</span>))
</span></span></code></pre></div><p>上面這段程式碼透過雲端讀取<code>結果查找</code>，並將其儲存於變項<code>data</code>。函數內的連結即是上面在設置<code>結果查找</code>的讀取權限時的共用分享連結。</p><h4 id=資料刪減>資料刪減</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>data <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>as.data.frame</span>(data)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#a6e22e>colnames</span>(data) <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>c</span>(<span style=color:#e6db74>&#34;DateTime&#34;</span>, <span style=color:#e6db74>&#34;Token&#34;</span>, <span style=color:#e6db74>&#34;Score&#34;</span>)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>data <span style=color:#f92672>&lt;-</span> data<span style=color:#a6e22e>[which</span>(<span style=color:#f92672>!</span><span style=color:#a6e22e>is.na</span>(data<span style=color:#f92672>$</span>DateTime)),]
</span></span></code></pre></div><p>上面的程式碼做了 3 件事(1 行 1 件事)：</p><ol><li>將<code>data</code>轉變成 base R 的<code>data.frame</code>。由<code>readr::read_csv</code>讀進來的<code>data.frame</code>會是<code>tibble</code>，而<code>tibble</code>在 DataCamp Light 的 console 印出時，會顯示出幾項對使用者沒用的訊息(這是 R 給資料分析者看的)，但傳統的 base R <code>data.frame</code>不會。</li><li>第二行則是將資料中每一個變項的名稱，更改為 <strong>DateTime</strong>(<code>時間戳記</code>)、<strong>Token</strong>(<code>Token</code>)、<strong>Score</strong>(<code>Score</code>)。括號內的名稱是<code>結果查找</code>內的變項名稱。</li><li>第三行是用以刪減多餘的資料。由於在<code>運算結果</code>套用公式時，勢必要為<strong>未來</strong>的儲存格著想：預先套入公式，才能計算未來產生的資料，因此，讀入的資料大多數都是空白的，僅有<code>Score</code>那欄為 6<sup id=fnref:6><a href=#fn:6 class=footnote-ref role=doc-noteref>6</a></sup>。</li></ol><h4 id=查找函數>查找函數</h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-R data-lang=R><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span>score <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>function</span>(token) {
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span>  i <span style=color:#f92672>&lt;-</span> <span style=color:#a6e22e>which</span>(data<span style=color:#f92672>$</span>Token <span style=color:#f92672>==</span> token)
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">3</span><span>  data[i,]
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">4</span><span>}
</span></span></code></pre></div><p>這是 DataCamp Light 在此最關鍵的功能。<code>score()</code>是一函數，讓填寫者透過當初於問卷填寫的 Token ，查詢自己的問卷回饋<sup id=fnref:7><a href=#fn:7 class=footnote-ref role=doc-noteref>7</a></sup>。該函數的功能，即是在<code>data</code>中的<code>Token</code>變項，尋找符合使用者輸入的值，並將符合的資料印在 console 上。</p><h3 id=顯示程式碼>顯示程式碼</h3><p>下面為<code>&lt;code data-type="sample-code">...&lt;/code></code>之間的程式碼，是使用者看的到的 R Script：</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">1</span><span><span style=color:#75715e># Put Token in &#34;&#34;. Ex: score(&#34;abcde123&#34;)</span>
</span></span><span style=display:flex><span style="white-space:pre;user-select:none;margin-right:.4em;padding:0 .4em;color:#7f7f7f">2</span><span><span style=color:#a6e22e>score</span>(<span style=color:#e6db74>&#34;Enter_your_Token&#34;</span>)
</span></span></code></pre></div><p>第一行是註解(同一行中，<code>#</code>之後的內容不會執行)，可用來說明。<br>第二行預先印出<code>score()</code>函數，讓使用者僅需輸入 Token 而不需自行打出函數。</p><h2 id=靜態網頁-設置>靜態網頁 設置</h2><p>對於完全沒有概念的人，設置靜態網頁可能會是比較困難的部分，因為多數人對此相當陌生。靜態網頁在此的目的是為了讓 DataCamp Light 的程式碼(即一段 HTML)能夠運行，因此若讀者使用的部落格平台允許自由變更網頁的 html 並且能自由匯入 JS<sup id=fnref:8><a href=#fn:8 class=footnote-ref role=doc-noteref>8</a></sup>，則可以忽略此節內容。</p><h3 id=github-pages>GitHub Pages</h3><p>架設靜態網頁<sup id=fnref:9><a href=#fn:9 class=footnote-ref role=doc-noteref>9</a></sup>並非難事，難的是做出漂亮的靜態網頁。然而，網頁越漂亮，其結構通常也更加複雜。如何(短時間)打造美觀的靜態網頁以及基礎 HTML, CSS 的概念並非此文的目的。對於有這些需求的讀者，我推薦 <a href=https://yihui.name/>Yihui Xie</a> 的 <a href=https://bookdown.org/yihui/blogdown/>blogdown</a>。</p><p>以下提供一個最精簡的例子，由註冊 GitHub 帳號到架設網頁，過程中僅需使用到瀏覽器(GUI)，不需用到 Git。</p><h4 id=註冊與建立-repo>註冊與建立 Repo</h4><ol><li><p>至 <a href=https://github.com/>https://github.com/</a> ，填寫註冊資訊(一個 email 僅能註冊一次)，並記得去信箱認證。<strong>Username</strong> 即為之後網站的網址，以下圖為例，minimalghpage.github.io。</p><p><img src=https://img.yongfu.name/assets/gsheet_post/github_signup.PNG alt></p></li><li><p>信箱認證後，將自動跳回 GitHub 頁面。之後，基本上不需更動出現之畫面的設定，只要按下一步。最後應會出現下圖，按右上角圖示並選取 <strong>Your Profile</strong>。</p><p><figure><img src=https://img.yongfu.name/assets/gsheet_post/gh_main.PNG alt="account info"><figcaption>account info</figcaption></figure></p></li><li><p>按下網頁中上方的 <strong>Repositories</strong> 後應會出現下圖，接著再按下右上方的綠色按鈕 <strong>New</strong>。</p><p><img src=https://img.yongfu.name/assets/gsheet_post/gh_repo.PNG alt></p></li><li><p>出現下圖後，在 <strong>Repository name</strong> 輸入<code>&lt;username>.github.io</code>(<code>&lt;username></code>一定要與當初註冊時填入的 <strong>Username</strong> 一模一樣)，並<strong>勾選</strong>下方 <strong>Initialize this repository with a README</strong>。最後按 <strong>Create repository</strong>。</p><p><img src=https://img.yongfu.name/assets/gsheet_post/create_repo.PNG alt></p></li></ol><h4 id=上傳網頁>上傳網頁</h4><ol><li><p><a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/liao961120/local_depend/tree/master/minimal_web_DataCampLight">下載</a> <strong>Minimal Web Page</strong> (下載後需解壓縮。)</p></li><li><p>至剛剛建立的 Repository (<code>&lt;username>.github.io</code>)，點擊 <strong>Upload files</strong> (圖中黃色螢光處)。</p><p><img src=https://img.yongfu.name/assets/gsheet_post/gh_upload.PNG alt></p></li><li><p>進入新畫面後，將<code>index.html</code>, <code>search.html</code>, <code>.nojekyll</code>拖曳上傳，並按下畫面最下方 <strong>Commit changes</strong>.</p></li><li><p>上傳完成後，即可看到下圖。<code>.nojekyll</code>不會顯示出來。</p><p><img src=https://img.yongfu.name/assets/gsheet_post/gh_uploaded.PNG alt></p></li><li><p>**完成！**過 1, 2 分鐘後，即可至<code>&lt;username>.github.io</code>檢視網頁。</p></li><li><p>之後若要修改檔案，將修改過後的檔案依相同步驟上傳即可。</p></li></ol><h3 id=minimal-web-page>Minimal Web Page</h3><p><a href=https://github.com/liao961120/local_depend/tree/master/minimal_web_DataCampLight>Minimal Web Page</a> 裡面有三個檔案：<code>index.html</code>, <code>search.html</code>, <code>.nojekyll</code>。</p><ul><li><code>index.html</code>: 這是網站的首頁，亦即瀏覽器進入<code>https://&lt;username>.github.io/</code>時所讀取的檔案。此檔案內含 HTML 必要結構，並且匯入 <a href=https://getbootstrap.com/docs/4.0/getting-started/introduction/>bootstrap</a> 的 CSS 和 JS 以快速製作漂亮的 Button 和 Modal。</li><li><code>search.html</code>：這份檔案即為上文 DataCamp light 的<a href=#%E5%AE%8C%E6%95%B4%E7%A8%8B%E5%BC%8F%E7%A2%BC>完整程式碼</a>，加上一些 HTML 的必要結構以及重新整理頁面的按鈕(Reload)。若需修改其中的 R Script，需用<a href=https://zh.wikipedia.org/wiki/%E6%96%87%E6%9C%AC%E7%BC%96%E8%BE%91%E5%99%A8>文字編輯器</a>開啟此檔案修改<code>&lt;code>...&lt;/code></code>裡面的內容。</li><li><code>.nojekyll</code>: <a href=https://help.github.com/articles/using-jekyll-as-a-static-site-generator-with-github-pages/>Jekyll</a> 是 GitHub Pages 預設的靜態網頁產生器，能自動將 Markdown 生成<code>.html</code>，對於常寫文章的使用者很方便：不需每次發文都要自己將文章轉為 html 檔。<code>.nojekyll</code>在此的作用是告訴 GitHub Pages <strong>不要使用 Jekyll 產生網頁</strong>，因為使用 Jekyll 產生網頁，repository 需符合特定的檔案格式與架構<sup id=fnref:10><a href=#fn:10 class=footnote-ref role=doc-noteref>10</a></sup>。</li></ul><h4 id=r-使用者>R 使用者</h4><p>會用 Rmarkdown 的人，可直接<a href="https://minhaskamal.github.io/DownGit/#/home?url=https://github.com/liao961120/blog/tree/masterhttps://img.yongfu.name/assets/gsheet_post/demo">下載</a><strong>回饋功能示範平台</strong>製作網頁(需額外安裝一些 package)，不須使用上述資料夾內的檔案。這能省下許多製作網頁(<code>index.html</code>)的時間。</p><p>R markdown 是 Markdown 的擴充，其輸出的 HTML 格式已經過簡單的排版，同時也支援 Bootstrap (<strong>Minimal Web Page</strong> 裡的 HTML 也有匯入 Bootstrap)，因此能夠輕易地製作出<strong>美觀</strong>的網頁。Rmarkdown 可輸出許多格式，其中 <a href=https://rmarkdown.rstudio.com/html_document_format.html>html_document</a> 最為簡單。Rmarkdown 的語法(<a href=https://www.rstudio.com/wp-content/uploads/2015/03/rmarkdown-reference.pdf>Cheat Sheet</a>)即為 Markdown 語法加上許多額外的功能(透過 R 實現)。</p><div id=privacy></div><h2 id=隱私問題>隱私問題</h2><p>在此需特別提醒問卷填寫者隱私的問題。由於查詢個人的問卷回饋需透過 DataCamp Light，其<strong>由雲端讀取之試算表(<code>結果查找</code>)是公開的</strong>。縱使網頁表面看不見<code>結果查找</code>的網址，但只要檢視網頁的原始碼(透過瀏覽器的開發人員工具，或至 GitHub 直接下載<code>search.html</code>)，即可取得<code>結果查找</code>的網址，並下載整份資料<sup id=fnref:11><a href=#fn:11 class=footnote-ref role=doc-noteref>11</a></sup>。</p><p>以這裡的例子說明，<code>結果查找</code>僅含有 3 欄：時間戳記、Token、分數。這 3 欄是任何人都能看見的內容，其中 <strong>Token 是由問卷填寫者直接填寫</strong>，因此</p><p>在設計問卷時，需於 Token 那題特別提醒填寫者：<strong>不能填寫能關聯到個人身份的內容，如學號、e-mail 等</strong>。</p><div style=font-size:10pt;text-align:right>Last updated: Apr 27, 2018</div><div class=footnotes role=doc-endnotes><hr><ol><li id=fn:1><p>其實 google 表單確實能即時回饋分數，但僅限<a href="https://support.google.com/docs/answer/7032287?hl=zh-Hant">測驗模式</a>，有諸多限制，例如，題目僅能為「對」或「錯」，無法處理反向計分的問題，無法使用線性刻度 (linear scale) 計分等。&#160;<a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2><p>若擔心填答人數超過 9998 人，可設個更大的數字，如<code>E99999</code>。&#160;<a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:3><p>你也可以設置時區，通常依據的是多數問卷填寫者所在位置的時區。這邊設為台北時間。&#160;<a href=#fnref:3 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:4><p>這邊是為了方便之後 R parse 日期格式。&#160;<a href=#fnref:4 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:5><p>這關係到隱私問題，詳見最後一節<a href=#privacy>隱私問題</a>&#160;<a href=#fnref:5 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:6><p>總分(Score) = 空白(Q1) + 空白(Q2) + 6(6 - Q3)。Q3 是反向計分的五點量尺。&#160;<a href=#fnref:6 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:7><p>若有兩筆以上的資料有相同的 Token，<code>score()</code>就會篩選出相同筆數的資料，並將這些資料印在 console 上。此時，可以透過 <strong>DateTime</strong> 那行來確定填寫時間，以找到自己填寫的那筆資料。&#160;<a href=#fnref:7 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:8><p>我對目前的部落格平台功能相當不熟悉，但就我所知提供此功能的應該不多。DataCamp Light 有提供 WordPress(不是 WordPress.com) 外掛，詳見 <a href=https://github.com/datacamp/datacamp-light-wordpress>DataCamp Light Wordpress Plugin</a>。&#160;<a href=#fnref:8 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:9><p>這裡的靜態網頁是架設在 GitHub 上，代表(1)可以任意修改網頁；(2)網頁的內容(檔案)是完全公開的。因此，相對於其他部落格平台，如 Blogger， 網站管理人的彈性相當大，而且網頁上不會出現廣告。然而，由於檔案是完全公開的，需<strong>注意隱私以及版權問題</strong>。&#160;<a href=#fnref:9 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:10><p>這是自行在 GitHub Pages 上架設部落格最困難的地方：使用者需對 Jekyll 有一定程度的理解。這同時也是我推薦 <a href=https://github.com/rstudio/blogdown>blogdown</a> 的原因，其讓使用者略過理解複雜的靜態網頁產生器，而能專心在網頁的內容上。&#160;<a href=#fnref:10 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:11><p>然<code>結果查找</code>透過<code>IMPORTRANGE</code>匯入的試算表只要<strong>未開放共用連結</strong>，仍是安全的。這也是為何即使僅需 2 個(或甚至 1 個)試算表和 DataCamp Light 即可做到問卷回饋，但我仍使用了 3 個試算表。<br>(另一原因是考量 google 及 DataCamp Light 的運算資源及時間。縱使我較喜歡，也應該要用 R 語言處理資料，考量到 google 擁有較強大及穩定的運算資源，多數的運算因此交給 google 試算表，而 DataCamp Light 僅用來讀取資料。)&#160;<a href=#fnref:11 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></div></div><br><br><div id=disqus_thread></div><script>var disqus_config=function(){this.page.url="",this.page.identifier=""};(function(){var e=document,t=e.createElement("script");t.src="https://y-f-liao-s-page.disqus.com/embed.js",t.setAttribute("data-timestamp",+new Date),(e.head||e.body).appendChild(t)})()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><div class=next-prev><div><span>PREV</span>
<a href=https://yongfu.name/2018/02/24/new_md_features/>Some New Features of TeXt Theme</a></div><div><span>NEXT</span>
<a href=https://yongfu.name/2018/07/23/rmd_intro/>My Notes on R Markdown</a></div></div></article><aside class="toc toc-right js-toc relative z-1 transition--300 absolute pa4 pt5 is-position-fixed"></aside></div><script src=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js></script>
<link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.css><script>tocbot.init({tocSelector:".js-toc",contentSelector:".article_content",headingSelector:"h2, h3, h4",hasInnerContainers:!0,collapseDepth:3})</script><style>ol.toc-list{list-style-type:none}aside{position:fixed;top:15%!important;right:2%}.next-prev{margin-top:2.5em;border-top:2px solid rgba(173,173,173,.548);display:flex;flex-wrap:wrap;justify-content:space-between}.next-prev>div{min-width:150px;width:43%}.next-prev>div>span{display:block;width:100%;color:grey;font-weight:600;letter-spacing:1.5px;padding-bottom:.3rem;margin-top:.4rem}.next-prev>div:nth-child(2){text-align:right}.next-prev>div>a{text-decoration:none;color:#000;font-weight:600}</style><footer><div class=social><span class=icon title="Send me an email"><a href=mailto:liao961120@gmail.com target=_blank><span class="social email"><svg aria-hidden="true" focusable="false" data-prefix="fas" data-icon="envelope" class="svg-inline--fa fa-envelope fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#fff" d="M502.3 190.8c3.9-3.1 9.7-.2 9.7 4.7V4e2c0 26.5-21.5 48-48 48H48c-26.5.0-48-21.5-48-48V195.6c0-5 5.7-7.8 9.7-4.7 22.4 17.4 52.1 39.5 154.1 113.6 21.1 15.4 56.7 47.8 92.2 47.6 35.7.3 72-32.8 92.3-47.6 102-74.1 131.6-96.3 154-113.7zM256 320c23.2.4 56.6-29.2 73.4-41.4 132.7-96.3 142.8-104.7 173.4-128.7 5.8-4.5 9.2-11.5 9.2-18.9v-19c0-26.5-21.5-48-48-48H48C21.5 64 0 85.5.0 112v19c0 7.4 3.4 14.3 9.2 18.9 30.6 23.9 40.7 32.4 173.4 128.7 16.8 12.2 50.2 41.8 73.4 41.4z"/></svg></span></a></span><span class=icon title="Follow me on Twitter"><a href=https://twitter.com/liao_yongfu target=_blank><span class="social twitter"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="twitter" class="svg-inline--fa fa-twitter fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><path fill="#fff" d="M459.37 151.716c.325 4.548.325 9.097.325 13.645.0 138.72-105.583 298.558-298.558 298.558-59.452.0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055.0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421.0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391.0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04.0-57.828 46.782-104.934 104.934-104.934 30.213.0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg></span></a></span><span class=icon title="Follow me on Facebook"><a href=https://www.facebook.com/liao961120 target=_blank><span class="social facebook"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="facebook-f" class="svg-inline--fa fa-facebook-f fa-w-10" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 320 512"><path fill="#fff" d="M279.14 288l14.22-92.66h-88.91v-60.13c0-25.35 12.42-50.06 52.24-50.06h40.42V6.26S260.43.0 225.36.0c-73.22.0-121.08 44.38-121.08 124.72v70.62H22.89V288h81.39v224h100.17V288z"/></svg></span></a></span><span class=icon title="Follow me on GitHub"><a href=https://github.com/liao961120 target=_blank><span class="social github"><svg aria-hidden="true" focusable="false" data-prefix="fab" data-icon="github" class="svg-inline--fa fa-github fa-w-16" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><path fill="#fff" d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6.0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6.0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3.0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1.0-6.2-.3-40.4-.3-61.4.0.0-70 15-84.7-29.8.0.0-11.4-29.1-27.8-36.6.0.0-22.9-15.7 1.6-15.4.0.0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5.0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9.0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4.0 33.7-.3 75.4-.3 83.6.0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6.0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9.0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg></span></a></span></div><p class=site_info><span class=copyright>© Yongfu's Blog 2017-2023</span></p><p class=theme_info>Powered by <a href=https://gohugo.io target=_blank>Hugo</a> & <a href=https://github.com/liao961120/TeXtLite target=_blank>TeXtLite Theme</a>.</p></footer><div class=scrollBtn><span id=scrolltop onclick=window.scrollTo(0,0)>&#9650;</span>
<span id=scrollbottom onclick=window.scrollTo(0,document.body.scrollHeight)>&#9660;</span></div><style>div.scrollBtn{display:flex;flex-wrap:wrap;width:1em;position:fixed;bottom:1.1%;right:.8%}#scrolltop,#scrollbottom{line-height:1;font-size:1.4rem;color:var(--link-transitiion-light)}#scrolltop:hover,#scrollbottom:hover{cursor:pointer;color:green;font-size:1.6rem}</style></body></html>