<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>R-bloggers on Yongfu's Blog</title><link>https://yongfu.name/tags/r-bloggers/</link><description>Recent content in R-bloggers on Yongfu's Blog</description><generator>Hugo -- gohugo.io</generator><language>en-us</language><lastBuildDate>Wed, 09 Sep 2020 00:00:00 +0000</lastBuildDate><atom:link href="https://yongfu.name/tags/r-bloggers/feed.xml" rel="self" type="application/rss+xml"/><item><title>Getting Tabular Data Through JavaScript in Compiled R Markdown Documents</title><link>https://yongfu.name/2020/09/09/getable/</link><pubDate>Wed, 09 Sep 2020 00:00:00 +0000</pubDate><guid>https://yongfu.name/2020/09/09/getable/</guid><description>&lt;p>Recently, I have learned more about JavaScript and created a few JS web apps. This gave me the idea that we can separate the &lt;em>content&lt;/em> and the &lt;em>data&lt;/em> in an HTML document to make it more &lt;strong>dynamic&lt;/strong>&amp;mdash;the content stays static while the data could be updated independently without rewriting or recompiling the HTML document. This could be done by utilizing JavaScript&amp;rsquo;s ability to asynchronously fetch data from the web and generate DOM elements based on these data.&lt;/p>
&lt;p>I implemented this idea in my new R package &lt;a href="https://github.com/liao961120/getable">&lt;code>getable&lt;/code>&lt;/a>. Basically, &lt;code>getable&lt;/code> lets the user insert &lt;em>dynamic&lt;/em> HTML tables in R Markdown (HTML output only) by providing the URLs to the tables&amp;rsquo; data. Every time when the compiled HTML document is opened, the data are fetched from the web and used to generate the HTML tables. This means that the user can update the data (e.g., hosted in a public GitHub repo) without recompiling the HTML from R Markdown.
In addition to hosting data in GitHub repos or on static sites, the user could use &lt;strong>Google Spreadsheets&lt;/strong> as the data store, as shown in the GIF below.&lt;/p>
&lt;p>
&lt;img src="https://img.yongfu.name/posts/getable.gif" alt="">
&lt;/p>
&lt;h2 id="installation">Installation&lt;/h2>
&lt;p>&lt;code>getable&lt;/code> is now on CRAN, which can be installed with:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>&lt;span style="color:#a6e22e">install.packages&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;getable&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>or, install the latest version from GitHub:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>remotes&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#a6e22e">install_github&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;liao961120/getable&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="usage">Usage&lt;/h2>
&lt;p>&lt;code>getable&lt;/code> comes with a template that you can import in RStudio by selecting: &lt;code>File &amp;gt; New File &amp;gt; R Markdown &amp;gt; From Template &amp;gt; HTML Tables with Dynamic Data {GETable}&lt;/code>.&lt;/p>
&lt;p>Or, you can simply run the command below in the R console:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>rmarkdown&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#a6e22e">draft&lt;/span>(&lt;span style="color:#e6db74">&amp;#34;name_your_file.Rmd&amp;#34;&lt;/span>, template &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;tablefromweb&amp;#34;&lt;/span>, package &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#e6db74">&amp;#34;getable&amp;#34;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The template contains several files, of which &lt;code>dfFromWeb.html&lt;/code>, &lt;code>dfFromWeb.js&lt;/code>, and &lt;code>dfFromWeb.css&lt;/code> are required for the compiled HTML to work properly (DO NOT change the RELATIVE PATHs between these files and the source Rmd). Note that you can style the appearance of the HTML tables with CSS in &lt;code>dfFromWeb.css&lt;/code>, and if you know a lot about JS, you can even modify the code in &lt;code>dfFromWeb.js&lt;/code> to use other JS libraries to generate the HTML tables. You can see a working example &lt;a href="https://yongfu.name/getable/demo/">here&lt;/a>.&lt;/p>
&lt;h3 id="inserting-tables">Inserting Tables&lt;/h3>
&lt;p>Simply use the function &lt;code>renderTable(&amp;quot;&amp;lt;URL&amp;gt;&amp;quot;)&lt;/code> in a code chunk to insert a dynamic HTML table. Remember to set the chunk option &lt;code>results='asis'&lt;/code>:&lt;/p>
&lt;pre tabindex="0">&lt;code class="language-rmd" data-lang="rmd">```{r results=&amp;#39;asis&amp;#39;}
getable::renderTable(&amp;#34;https://yongfu.name/getable/demo/data/df.csv&amp;#34;)
```
&lt;/code>&lt;/pre></description><category>R</category><category>R Markdown</category><category>JavaScript</category><category>R-bloggers</category></item><item><title>Tips to Reduce the Complexity of Slide Making with Xaringan</title><link>https://yongfu.name/2019/04/29/xaringan_tips/</link><pubDate>Mon, 29 Apr 2019 00:00:00 +0000</pubDate><guid>https://yongfu.name/2019/04/29/xaringan_tips/</guid><description>&lt;p>Although I&amp;rsquo;m a strong believer in R Markdown, I&amp;rsquo;m not so sure about it in the realm of slide making. After using GUI slide making tools such as Powerpoint or Google Slides for years, it is not easy to get used to making slides with markdown, since it requires additional processing in the brain &amp;ndash; the conversion between images in the brain and the markup language to create them on the slides.
&lt;a href="https://yihui.name/en/2019/02/ultimate-inf-mr/">&lt;code>xaringan::inf_mr()&lt;/code>&lt;/a> greatly reduces this burden on the brain, but one serious drawback still persists. When making slides with Markdown, the source document often gets very long. I frequently found myself lost in the source document (after scrolling up and down), not knowing which part of the slide is it that I&amp;rsquo;m looking at&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>.
To be fair, there are great things about making slides with markdown, for example, it&amp;rsquo;s easier to manage and reuse images through URLs, and markdown is convenient for formatting code (automatic syntax highlighting).&lt;/p>
&lt;p>I have been making a lot of slides with Xaringan lately. After spending hours on Xaringan, I began to have more faith in making slides with markdown because I figured out some tips to reduce the pain caused by markup langauges. The idea is simple &amp;ndash; reduce the length and complexity of the source R Markdown document. &lt;code>knitr&lt;/code> is my friend here.&lt;/p>
&lt;h2 id="use-several-source-documents">Use Several Source Documents&lt;/h2>
&lt;p>&lt;a href="https://github.com/rstudio/bookdown">bookdown&lt;/a> uses several Rmd files to generate a book. The same idea can be used in Xaringan, and here are some advantages I can think of:&lt;/p>
&lt;ul>
&lt;li>
&lt;p>By splitting the source document into several meaningful sub-documents, you can locate particular parts of your slide faster (the so-called &amp;ldquo;&lt;a href="https://en.wikipedia.org/wiki/Chunking_(psychology)">chunking&lt;/a>&amp;rdquo;).&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Your slides can be easily reused, since you can copy a part of your slides by choosing the relevent Rmd file(s). (Not copy-and-pasting text from the parts you want in one lengthy Rmd file)&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="child-document">Child Document&lt;/h3>
&lt;p>To use several source Rmd documents to generate a single Xaringan (or any R Markdown) output, use knitr chunk option &lt;code>child&lt;/code> to include other Rmd files in a Rmd document. For example, I would create one &lt;code>index.Rmd&lt;/code> and several Rmd files with meaningful names (e.g., &lt;code>opening.Rmd&lt;/code>, &lt;code>intro-github.Rmd&lt;/code>, &lt;code>contact.Rmd&lt;/code>, etc.):&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1&lt;/span>&lt;span>&lt;span style="color:#ae81ff">my-slide/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── index.Rmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── opening.Rmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── intro-github.Rmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── contact.Rmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── html-table.txt&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── img/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8&lt;/span>&lt;span>&lt;span style="color:#ae81ff">└── addons/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9&lt;/span>&lt;span> &lt;span style="color:#ae81ff">   ├── custom.css&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10&lt;/span>&lt;span> &lt;span style="color:#ae81ff">   └── macros.js&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The chunk option &lt;code>child&lt;/code> is then used in &lt;code>index.Rmd&lt;/code> to include other &lt;code>*.Rmd&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2&lt;/span>&lt;span>&lt;span style="color:#ae81ff">```{r setup, include=FALSE}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3&lt;/span>&lt;span>&lt;span style="color:#ae81ff">knitr::opts_chunk$set(echo = FALSE)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4&lt;/span>&lt;span>&lt;span style="color:#ae81ff">options(knitr.duplicate.label = &amp;#39;allow&amp;#39;)&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5&lt;/span>&lt;span>&lt;span style="color:#ae81ff">```&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7&lt;/span>&lt;span>&lt;span style="color:#ae81ff">```{r child=&amp;#39;opening.Rmd&amp;#39;}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8&lt;/span>&lt;span>&lt;span style="color:#ae81ff">```&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10&lt;/span>&lt;span>&lt;span style="color:#ae81ff">```{r child=&amp;#39;contact.Rmd&amp;#39;}&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11&lt;/span>&lt;span>&lt;span style="color:#ae81ff">```&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="complex-markups-in-independent-files">Complex Markups in Independent Files&lt;/h2>
&lt;p>Sometimes we may want to put cool things in the slides that can only be created from HTML syntax, for example, the table below (generated from &lt;a href="https://www.tablesgenerator.com/html_tables#">TablesGenerator.com&lt;/a>):&lt;/p>
&lt;table style="border-collapse:collapse;border-spacing:0;margin:0px auto" class="tg">&lt;tr>&lt;th style="font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;text-align:center" colspan="2" rowspan="2">&lt;/th>&lt;th style="font-family:Arial, sans-serif;font-size:14px;font-weight:bold;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;text-align:center" colspan="2">Heuristic&lt;/th>&lt;/tr>&lt;tr>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#efefef;text-align:center">plausible&lt;/td>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#efefef;text-align:center">implausible&lt;/td>&lt;/tr>&lt;tr>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;font-weight:bold;text-align:center" rowspan="2">Syntax-driven&lt;/td>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#efefef;text-align:center">plausible&lt;/td>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#9abad9;text-align:center">&lt;span style="text-decoration: line-through;">P600&lt;/span>&lt;br>&lt;span style="text-decoration: line-through;">N400&lt;/span>&lt;/td>&lt;td style="font-family:Arial, sans-serif;font-size:medium;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#9abad9;text-align:center">&lt;span style="color:rgb(254, 0, 0)">✗&lt;/span>&lt;/td>&lt;/tr>&lt;tr>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#efefef;text-align:center">implausible&lt;/td>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#9abad9;text-align:center">P600&lt;/td>&lt;td style="font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:1px;overflow:hidden;word-break:normal;border-color:#343434;background-color:#9abad9;text-align:center">N400&lt;/td>&lt;/tr>&lt;/table>
&lt;p>This table looks simple, but it is generated by a 2728-character-long HTML code, which greatly increases the length and complexity of the source document. To make the source document cleaner, you can put code of these kinds in separate text files and include them into the R Markdown source document by &lt;code>knitr::asis_output(readLines('html-table.txt'))&lt;/code>&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup> and R Markdown &lt;a href="https://rmarkdown.rstudio.com/lesson-4.html">inline code&lt;/a> &lt;code>&lt;code>r &lt;/code>&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-markdown" data-lang="markdown">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>A table generated from
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2&lt;/span>&lt;span>[&lt;span style="color:#f92672">TablesGenerator.com&lt;/span>](&lt;span style="color:#a6e22e">https://www.tablesgenerator.com/html_tables#&lt;/span>):
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4&lt;/span>&lt;span>&lt;span style="color:#e6db74">`r knitr::asis_output(readLines(&amp;#39;html-table.txt&amp;#39;))`&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h2 id="remarkjs-built-in-functionalities">remark.js Built-in Functionalities&lt;/h2>
&lt;p>&lt;a href="https://github.com/gnab/remark">remark.js&lt;/a> actually provides useful functionalities to help reduce the complexity of the slides. &lt;strong>READ THE DOCs&lt;/strong>, and it might save you a great deal of time. &lt;a href="https://github.com/yihui/xaringan/wiki">Xaringan&lt;/a> and &lt;a href="https://github.com/gnab/remark/wiki">remark.js&lt;/a> both provide good wiki pages, and I regret I read them too late &amp;ndash; after I spent a lot of time copy-and-pasting and made my Rmd source document uglier.&lt;/p>
&lt;p>Below are some notes extract from Xaringan &amp;amp; remark.js Wiki pages. They serve as quick references (for myself) and aren&amp;rsquo;t meant to be detailed. Again, &lt;strong>READ THE DOCs&lt;/strong>!&lt;/p>
&lt;h3 id="configuration">Configuration&lt;/h3>
&lt;p>Xaringan Configuration (remark has a more thorough &lt;a href="https://github.com/gnab/remark/wiki/Configuration">documentation&lt;/a>) is set in YAML frontmatter:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yml" data-lang="yml">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1&lt;/span>&lt;span>&lt;span style="color:#f92672">output&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2&lt;/span>&lt;span> &lt;span style="color:#f92672">xaringan::moon_reader&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3&lt;/span>&lt;span> &lt;span style="color:#f92672">nature&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4&lt;/span>&lt;span> &lt;span style="color:#f92672">ratio&lt;/span>: &lt;span style="color:#e6db74">&amp;#34;16:10&amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5&lt;/span>&lt;span> &lt;span style="color:#f92672">beforeInit&lt;/span>: [&lt;span style="color:#e6db74">&amp;#34;addons/macros.js&amp;#34;&lt;/span>, &lt;span style="color:#e6db74">&amp;#34;https://platform.twitter.com/widgets.js&amp;#34;&lt;/span>]
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6&lt;/span>&lt;span> &lt;span style="color:#f92672">highlightLines&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7&lt;/span>&lt;span> &lt;span style="color:#f92672">highlightSpans&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8&lt;/span>&lt;span> &lt;span style="color:#f92672">navigation&lt;/span>:
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9&lt;/span>&lt;span> &lt;span style="color:#f92672">scroll&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10&lt;/span>&lt;span> &lt;span style="color:#f92672">css&lt;/span>: [&lt;span style="color:#ae81ff">default, default-fonts, addons/custom.css]&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11&lt;/span>&lt;span> &lt;span style="color:#f92672">yolo&lt;/span>: &lt;span style="color:#66d9ef">false&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12&lt;/span>&lt;span> &lt;span style="color:#f92672">seal&lt;/span>: &lt;span style="color:#66d9ef">true&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="remark-special-syntax">remark Special Syntax&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>&lt;a href="https://github.com/gnab/remark/wiki/Markdown#name">name&lt;/a>: Adding ID to a slide&lt;/p>
&lt;pre tabindex="0">&lt;code>name: about
## About
&lt;/code>&lt;/pre>&lt;ul>
&lt;li>reference with &lt;code>see [About](#about)&lt;/code>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://github.com/gnab/remark/wiki/Markdown#count">count&lt;/a>&lt;/p>
&lt;pre tabindex="0">&lt;code>count: false
This slide will not be counted.
&lt;/code>&lt;/pre>&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://github.com/gnab/remark/wiki/Markdown#template">template&lt;/a>&lt;/p>
&lt;pre>&lt;code>name: template-slide
Some content.
---
template: template-slide
Content appended to template-slide's content.
&lt;/code>&lt;/pre>
&lt;/li>
&lt;li>
&lt;p>&lt;a href="https://github.com/yihui/xaringan/wiki/Slide-layouts">layout&lt;/a>&lt;/p>
&lt;/li>
&lt;/ul>
&lt;h3 id="macros">Macros&lt;/h3>
&lt;ul>
&lt;li>
&lt;p>Image with Absolute postition:&lt;/p>
&lt;p>Define macros in &lt;code>addons/macros.js&lt;/code>:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-javascript" data-lang="javascript">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>&lt;span style="color:#a6e22e">remark&lt;/span>.&lt;span style="color:#a6e22e">macros&lt;/span>[&lt;span style="color:#e6db74">&amp;#39;abs&amp;#39;&lt;/span>] &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">function&lt;/span>(&lt;span style="color:#a6e22e">width&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;30%&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">left&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;85%&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">top&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;15%&amp;#34;&lt;/span>, &lt;span style="color:#a6e22e">cl&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;&amp;#34;&lt;/span>) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2&lt;/span>&lt;span>&lt;span style="color:#66d9ef">var&lt;/span> &lt;span style="color:#a6e22e">url&lt;/span> &lt;span style="color:#f92672">=&lt;/span> &lt;span style="color:#66d9ef">this&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3&lt;/span>&lt;span>&lt;span style="color:#66d9ef">return&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;lt;img src=&amp;#34;&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">url&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#34; style=&amp;#34;position:absolute;left:&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">left&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;;top:&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">top&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;;width:&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">width&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#34; class=&amp;#34;&amp;#39;&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#a6e22e">cl&lt;/span> &lt;span style="color:#f92672">+&lt;/span> &lt;span style="color:#e6db74">&amp;#39;&amp;#34; /&amp;gt;&amp;#39;&lt;/span>;
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4&lt;/span>&lt;span>};
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>Use it in markdown:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-markdown" data-lang="markdown">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>![&lt;span style="color:#f92672">:abs width, left, top&lt;/span>](&lt;span style="color:#a6e22e">url&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3&lt;/span>&lt;span>![&lt;span style="color:#f92672">:abs 30%, 50%, 0%&lt;/span>](&lt;span style="color:#a6e22e">url&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4&lt;/span>&lt;span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5&lt;/span>&lt;span>&amp;lt;&lt;span style="color:#f92672">img&lt;/span> &lt;span style="color:#a6e22e">src&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;url&amp;#34;&lt;/span> &lt;span style="color:#a6e22e">style&lt;/span>&lt;span style="color:#f92672">=&lt;/span>&lt;span style="color:#e6db74">&amp;#34;position:absolute; width:30%; left:50%; top:0%;&amp;#34;&lt;/span>&amp;gt;
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>This is the major drawback of markup languages compared to GUI authoring tools. Although markdown itself is designed to deal with this drawback (i.e. the too-complicated HTML syntax), the inherently complex structure of slideshows still complicates the source document of the slides writen in markdown.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>Note that there is only one line in &lt;code>html-table.txt&lt;/code> so &lt;code>readLines()&lt;/code> returns a character vector of length 1. If there are multiple lines in the text file, one needs to use &lt;code>paste(readLines('html-table.txt'), collapse = '\n')&lt;/code> to properly print out the text file.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description><category>experience</category><category>R Markdown</category><category>R-bloggers</category></item><item><title>Wrapper of knitr::include_graphics to Handle URLs &amp; PDF Outputs</title><link>https://yongfu.name/2019/03/10/include_graphics2/</link><pubDate>Sun, 10 Mar 2019 00:00:00 +0000</pubDate><guid>https://yongfu.name/2019/03/10/include_graphics2/</guid><description>&lt;p>Those who use &lt;code>knitr::include_graphics()&lt;/code> frequently in their R Markdown files may discover some inconsistencies (from the user point of view) if the same Rmd is used for multiple output formats, especially when PDF (LaTeX) is involved.&lt;/p>
&lt;p>The following code works fine for HTML outputs but fails when the outputs are PDFs:&lt;/p>
&lt;ol>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>knitr&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#a6e22e">include_graphics&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;local.gif&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>knitr&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#a6e22e">include_graphics&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;https://commonmark.org/images/markdown-mark.png&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>The first case is obvious since it&amp;rsquo;s impossible to include a GIF in a PDF document. The second case may cause some users to scratch their heads: &amp;ldquo;Why can&amp;rsquo;t I insert a PNG image in the PDF document?&amp;rdquo;. The answer is that, for PDFs, &lt;code>knitr::include_graphics()&lt;/code> only works for &lt;strong>local images&lt;/strong> because &lt;code>knitr::include_graphics&lt;/code> won&amp;rsquo;t download the images for you, whereas for HTMLs, the images don&amp;rsquo;t have to be downloaded (images can be sourced using HTML &lt;code>img&lt;/code> tags).&lt;/p>
&lt;p>To fix the problem that arise in the first case, one can use images that are compatible for both output formats, such as PNG or JPEG. Another solution is to include different figures for different output formats:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>&lt;span style="color:#a6e22e">if &lt;/span>(knitr&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#a6e22e">is_html_output&lt;/span>()) {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2&lt;/span>&lt;span> knitr&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#a6e22e">include_graphics&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;local.gif&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3&lt;/span>&lt;span>} else {
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">4&lt;/span>&lt;span> knitr&lt;span style="color:#f92672">::&lt;/span>&lt;span style="color:#a6e22e">include_graphics&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;local.png&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">5&lt;/span>&lt;span>}
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>To fix the problem that arise in the second case, one has to remember not to pass an URL as &lt;code>path&lt;/code> to &lt;code>knitr::include_graphics()&lt;/code> if the Rmd is to be compiled to PDFs.&lt;/p>
&lt;h2 id="include_graphics2">include_graphics2()&lt;/h2>
&lt;p>I can never be sure when I would want to make my Rmd, originally targeted for HTML outputs, available in PDFs. Also, I don&amp;rsquo;t want to write &lt;code>if (knitr::is_html_output())&lt;/code> every time I want to include a GIF. It is also a headache to download every figure from the web just for the PDF output.
So I decided to write a wrapper of &lt;code>knitr::include_graphics()&lt;/code> for myself, dealing with all the problems mentioned above.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>For including different figures for HTML and PDF outputs, use:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>&lt;span style="color:#a6e22e">include_graphics2&lt;/span>(&lt;span style="color:#e6db74">&amp;#39;local.gif&amp;#39;&lt;/span>, &lt;span style="color:#e6db74">&amp;#39;local.png&amp;#39;&lt;/span>)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>The first argument &lt;code>local.gif&lt;/code> is used when the output format is HTML, and the second, &lt;code>local.png&lt;/code>, is used when it&amp;rsquo;s PDF.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>&lt;code>include_graphics2()&lt;/code> also works fine with URLs. It is totally fine to use URLs instead of local file paths in the example above:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>png_url &lt;span style="color:#f92672">&amp;lt;-&lt;/span> &lt;span style="color:#e6db74">&amp;#39;https://commonmark.org/images/markdown-mark.png&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2&lt;/span>&lt;span>gif_url &lt;span style="color:#f92672">&amp;lt;-&lt;/span> &lt;span style="color:#e6db74">&amp;#39;https://media.giphy.com/media/k3dcUPvxuNpK/giphy.gif&amp;#39;&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">3&lt;/span>&lt;span>&lt;span style="color:#a6e22e">include_graphics2&lt;/span>(png_url, gif_url)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ul>
&lt;h3 id="source-code">Source Code&lt;/h3>
&lt;p>I made &lt;code>include_graphics2()&lt;/code> available through a package I maintain (&lt;a href="https://liao961120.github.io/linguisticsdown">&lt;code>lingusiticsdown&lt;/code>&lt;/a>). You can read the
&lt;a href="https://liao961120.github.io/linguisticsdown/reference/include_graphics2.html">documentation&lt;/a> of &lt;code>include_graphics2()&lt;/code> and a
&lt;a href="https://liao961120.github.io/linguisticsdown/articles/include_graphics_wrapper.html">vignette&lt;/a> of its usage on the package web page.&lt;/p>
&lt;p>For those who want to use &lt;code>include_graphics2()&lt;/code> but don&amp;rsquo;t want to depend on &lt;code>linguisticsdown&lt;/code>, feel free to copy the &lt;a href="https://github.com/liao961120/linguisticsdown/blob/master/R/include_graphics2.R">source&lt;/a> of &lt;code>include_graphics2()&lt;/code> to your personal package. If you don&amp;rsquo;t have one, you can still use the source script as regular R scripts, but remember to add the following lines to the top of the script:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-r" data-lang="r">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">1&lt;/span>&lt;span>&lt;span style="color:#a6e22e">library&lt;/span>(knitr)
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">2&lt;/span>&lt;span>&lt;span style="color:#a6e22e">library&lt;/span>(tools)
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div></description><category>R Markdown</category><category>R-bloggers</category></item><item><title>Visualizing Language Loss in Taiwan</title><link>https://yongfu.name/2019/02/17/visualize-language-loss/</link><pubDate>Sun, 17 Feb 2019 00:00:00 +0000</pubDate><guid>https://yongfu.name/2019/02/17/visualize-language-loss/</guid><description>
&lt;p>&lt;a href="https://twlangsurvey.github.io">Taiwan Language Survey&lt;/a> is a small project I worked on during May to June in 2018. The idea was to create a survey that &lt;strong>continuously&lt;/strong> collects data and a web page that visualizes the collected data. The web page is updated weekly using &lt;a href="https://travis-ci.org/twLangSurvey/twLangSurvey.github.io">Travis-CI&lt;/a>.&lt;/p>
&lt;p>The main purpose of this survey is to raise public awareness of &lt;strong>language loss&lt;/strong> in Taiwan. Hence, the survey is designed to collect data that can provide valuable information about language loss, for example, some questions were asked to gain insight about the change of linguistic competence acoss generations in a family (i.e. across the subject’s parents, the subject, and the subject’s children). In addition to changes within family, information about the age of the subjects is also colleceted, meaning that we can see how linguistic competence changes among diffrent age groups of subjects in a community, i.e. is a language becoming more dominant or entering the dying process?&lt;/p>
&lt;p>Visualization is a powerful tool to capture how linguistic competences of different langauges are changing. But creating visualizations necessitates creativity – how can language loss be visualized? Below, I illustrate one of the methods I created for visualizing language loss – a visaulization inspired by the &lt;a href="https://en.wikipedia.org/wiki/Population_pyramid">age-sex pyramid&lt;/a>.&lt;/p>
&lt;div id="age-sex-pyramid-of-language" class="section level2">
&lt;h2>Age-Sex Pyramid of Language&lt;/h2>
&lt;p>The age-sex pyramid is used to visualize the population structure of a community. The vertical axis indicates the age and each horizontal bar represents an age group. The horizontal axis indicates the population size of male or female of a particular age group.&lt;/p>
&lt;p>The age-sex pyramid is a great tool to visualize the population structure since the ‘shape’ of the pyramid gives readers a lot information. For example, an ‘expansive pyramid’ has longer bars at the bottom of the pyramid, which indicates the population is young and growing. A ‘stationary pyramid’ looks like a rectangular bar, indicating the population sizes of different age groups are about the same. A ‘constructive’ pyramid indicates a shrinking population, which is narrowed at the bottom.&lt;/p>
&lt;p>Similarly, a &lt;strong>modified&lt;/strong> version of the age-sex pyramid, which I’ll call the ‘&lt;strong>age-sex pyramid of language&lt;/strong>’, can be used to visualize the population structure of a language and predicts the language’s &lt;strong>vitality&lt;/strong>. Instead of visualizing population size, the age-sex pyramid of language visualizes the &lt;strong>average fluency of a language&lt;/strong> on the horizontal axis.&lt;/p>
&lt;div class="figure">&lt;span id="fig:tw-pyramid">&lt;/span>
&lt;img src="https://twlangsurvey.github.io/out_graph/Tw_pyramid.png" alt="An age-sex pyramid of Taiwanese. The red bars on the left indicates females of different age groups and the blue bars on the right indicates males. The average fluency (values on the horizontal axis) is calculated from a six-point scale (0-5) on Taiwanese fluency." width="70%" />
&lt;p class="caption">
Figure 1: An age-sex pyramid of Taiwanese. The red bars on the left indicates females of different age groups and the blue bars on the right indicates males. The average fluency (values on the horizontal axis) is calculated from a six-point scale (0-5) on Taiwanese fluency.
&lt;/p>
&lt;/div>
&lt;p>As shown in Figure &lt;a href="#fig:tw-pyramid">1&lt;/a>, the shape of the age-sex pyramid of &lt;a href="https://en.wikipedia.org/wiki/Taiwanese_Hokkien">Taiwanese&lt;/a> in Taiwan&lt;a href="#fn1" class="footnote-ref" id="fnref1">&lt;sup>1&lt;/sup>&lt;/a> is an ‘&lt;strong>inverted triangle&lt;/strong>’, which is almost never seen in the conventional population pyramid. However, this inverted triangular shape is expected to appear quite often, since it indicates an ongoing language loss in a community.&lt;/p>
&lt;table>
&lt;thead>
&lt;tr class="header">
&lt;th>&lt;strong>Vitality of Language&lt;/strong>&lt;/th>
&lt;th>&lt;strong>Shape of Pyramid&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td>Shrinking and Dying&lt;/td>
&lt;td>Inverted Triangle&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td>Growing&lt;/td>
&lt;td>Triangle&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td>Stable&lt;/td>
&lt;td>Rectangular Bar&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;div id="drawing-age-sex-pyramid-with-ggplot2" class="section level2">
&lt;h2>Drawing Age-Sex Pyramid with ggplot2&lt;/h2>
&lt;p>As complex as it might seem, an age-sex pyramid created with ggplot2 is actually a (modified) bar chart. I learned this on &lt;a href="https://stackoverflow.com/a/36804394">stackoverflow&lt;/a>, and the trick is&lt;/p>
&lt;ol style="list-style-type: decimal">
&lt;li>Use &lt;code>ifelse&lt;/code> to flip the value (here, population size) according to the gender of the age group&lt;/li>
&lt;li>Use &lt;code>geom_bar(stat = &amp;quot;identity&amp;quot;)&lt;/code> to let the heights of the bars represent values in the data frame, i.e. the value given to &lt;code>y&lt;/code>&lt;/li>
&lt;li>Use &lt;code>coord_flip()&lt;/code> to make the bars horizontal&lt;/li>
&lt;/ol>
&lt;pre class="language-r">&lt;code class="language-r">&lt;span class="kw">set.seed&lt;/span>(&lt;span class="dv">1&lt;/span>)
df0 &amp;lt;-&lt;span class="st"> &lt;/span>tibble&lt;span class="op">::&lt;/span>&lt;span class="kw">tibble&lt;/span>(
&lt;span class="dt">Age =&lt;/span> &lt;span class="kw">rep&lt;/span>(&lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;#39;10-19&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;20-29&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;30-39&amp;#39;&lt;/span>), &lt;span class="dv">2&lt;/span>),
&lt;span class="dt">Gender =&lt;/span> &lt;span class="kw">rep&lt;/span>(&lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;#39;Female&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Male&amp;#39;&lt;/span>), &lt;span class="dt">each =&lt;/span> &lt;span class="dv">3&lt;/span>),
&lt;span class="dt">PopSize =&lt;/span> &lt;span class="kw">sample&lt;/span>(&lt;span class="dv">0&lt;/span>&lt;span class="op">:&lt;/span>&lt;span class="dv">100&lt;/span>, &lt;span class="dt">size =&lt;/span> &lt;span class="dv">6&lt;/span>, &lt;span class="dt">replace =&lt;/span> T)
)
df0&lt;/code>&lt;/pre>
&lt;div class="kable-table">
&lt;table>
&lt;thead>
&lt;tr class="header">
&lt;th align="left">Age&lt;/th>
&lt;th align="left">Gender&lt;/th>
&lt;th align="right">PopSize&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td align="left">10-19&lt;/td>
&lt;td align="left">Female&lt;/td>
&lt;td align="right">26&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">20-29&lt;/td>
&lt;td align="left">Female&lt;/td>
&lt;td align="right">37&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="left">30-39&lt;/td>
&lt;td align="left">Female&lt;/td>
&lt;td align="right">57&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">10-19&lt;/td>
&lt;td align="left">Male&lt;/td>
&lt;td align="right">91&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="left">20-29&lt;/td>
&lt;td align="left">Male&lt;/td>
&lt;td align="right">20&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">30-39&lt;/td>
&lt;td align="left">Male&lt;/td>
&lt;td align="right">90&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;pre class="language-r">&lt;code class="language-r">&lt;span class="kw">library&lt;/span>(ggplot2)
pl &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">ggplot&lt;/span>(df0, &lt;span class="kw">aes&lt;/span>(&lt;span class="dt">x =&lt;/span> Age,
&lt;span class="dt">y =&lt;/span> &lt;span class="kw">ifelse&lt;/span>(Gender &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Male&amp;#39;&lt;/span>, PopSize, &lt;span class="op">-&lt;/span>PopSize),
&lt;span class="dt">fill =&lt;/span> Gender)) &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">geom_bar&lt;/span>(&lt;span class="dt">stat =&lt;/span> &lt;span class="st">&amp;#39;identity&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">coord_flip&lt;/span>()
pl&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://img.yongfu.name/assets/visualize-language-loss/unnamed-chunk-1-1.png" width="70%" />&lt;/p>
&lt;p>To center the plot (i.e. to make the point where population size is zero at the center of the plot), we have to scale the axis of ‘population size’ (&lt;code>y&lt;/code>) with &lt;code>scale_y_continuous&lt;/code>:&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">pl &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>&lt;span class="kw">scale_y_continuous&lt;/span>(&lt;span class="dt">limits =&lt;/span> &lt;span class="kw">c&lt;/span>(&lt;span class="op">-&lt;/span>&lt;span class="dv">100&lt;/span>, &lt;span class="dv">100&lt;/span>),
&lt;span class="dt">breaks =&lt;/span> &lt;span class="kw">seq&lt;/span>(&lt;span class="op">-&lt;/span>&lt;span class="dv">100&lt;/span>, &lt;span class="dv">100&lt;/span>, &lt;span class="dv">25&lt;/span>),
&lt;span class="dt">labels =&lt;/span> abs) &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">labs&lt;/span>(&lt;span class="dt">y =&lt;/span> &lt;span class="st">&amp;#39;Population Size&amp;#39;&lt;/span>)&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://img.yongfu.name/assets/visualize-language-loss/unnamed-chunk-2-1.png" width="70%" />&lt;/p>
&lt;p>where &lt;code>abs&lt;/code> in &lt;code>labels&lt;/code> is the function &lt;code>abs()&lt;/code>. By default, &lt;code>ggplot2&lt;/code> pass the value given in &lt;code>breaks&lt;/code> to the the function specified in &lt;code>labels&lt;/code>.&lt;/p>
&lt;/div>
&lt;div id="visualizing-language-loss" class="section level2">
&lt;h2>Visualizing Language Loss&lt;/h2>
&lt;p>To create an age-sex pyramid of language, the data structure needed is exactly the same as the one above, except the variable, &lt;code>PopSize&lt;/code>, is replaced by ‘average fluency’ of a language. But since most people in Taiwan can speak more than one language (e.g. Mandarin-Taiwanese, Mandarin-Taiwanese-Hakka, Mandarin-English, etc.), the real data from the survey is a bit more complex Basically, the data structure needed to draw an age-sex pyramid of language looks like:&lt;/p>
&lt;table>
&lt;thead>
&lt;tr class="header">
&lt;th>&lt;strong>Gender&lt;/strong>&lt;/th>
&lt;th>&lt;strong>Ethnicity&lt;/strong>&lt;/th>
&lt;th>&lt;strong>Age Group&lt;/strong>&lt;/th>
&lt;th>&lt;strong>Avg. Fluency&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td>female&lt;/td>
&lt;td>Mandarin&lt;/td>
&lt;td>20-24&lt;/td>
&lt;td>4.53&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td>male&lt;/td>
&lt;td>Taiwanese&lt;/td>
&lt;td>20-24&lt;/td>
&lt;td>2.78&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td>…&lt;/td>
&lt;td>…&lt;/td>
&lt;td>…&lt;/td>
&lt;td>…&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td>female&lt;/td>
&lt;td>Hakka&lt;/td>
&lt;td>25-29&lt;/td>
&lt;td>2.23&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td>male&lt;/td>
&lt;td>Taiwanese&lt;/td>
&lt;td>35-39&lt;/td>
&lt;td>3.57&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;div id="preparation-of-data" class="section level3">
&lt;h3>Preparation of Data&lt;/h3>
&lt;p>The raw data of &lt;a href="https://twlangsurvey.github.io/">Taiwan Language Survey&lt;/a> can be retrieved &lt;a href="https://docs.google.com/spreadsheets/d/1NOJ9O_zBR6s-9e1fFGVcRaBjn5qQuVB9ZeSebhBctoM/edit?usp=sharing">here&lt;/a>. The survey and raw data is in traditional Chinese. I’ll skip the step of cleaning raw data (e.g., turn variable names to English) and used the cleaned data &lt;code>survey.rds&lt;/code> instead.&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">temp &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">tempfile&lt;/span>()
&lt;span class="kw">download.file&lt;/span>(&lt;span class="st">&amp;#39;https://raw.githubusercontent.com/twLangSurvey/twLangSurvey.github.io/master/data/survey.rds&amp;#39;&lt;/span>, &lt;span class="dt">destfile =&lt;/span> temp)
data &amp;lt;-&lt;span class="st"> &lt;/span>readr&lt;span class="op">::&lt;/span>&lt;span class="kw">read_rds&lt;/span>(temp)
&lt;span class="kw">head&lt;/span>(data, &lt;span class="dv">3&lt;/span>)&lt;/code>&lt;/pre>
&lt;div class="kable-table">
&lt;table>
&lt;thead>
&lt;tr class="header">
&lt;th align="left">date&lt;/th>
&lt;th align="left">curr_resid&lt;/th>
&lt;th align="right">curr_resid_since&lt;/th>
&lt;th align="left">settle_5yy&lt;/th>
&lt;th align="left">home_town&lt;/th>
&lt;th align="left">gender&lt;/th>
&lt;th align="right">age&lt;/th>
&lt;th align="right">kid_num&lt;/th>
&lt;th align="left">edu_level&lt;/th>
&lt;th align="left">work&lt;/th>
&lt;th align="left">income&lt;/th>
&lt;th align="left">work_hr&lt;/th>
&lt;th align="left">tribe&lt;/th>
&lt;th align="right">Mand_listen&lt;/th>
&lt;th align="right">Mand_speak&lt;/th>
&lt;th align="right">Tw_listen&lt;/th>
&lt;th align="right">Tw_speak&lt;/th>
&lt;th align="right">Hak_listen&lt;/th>
&lt;th align="right">Hak_speak&lt;/th>
&lt;th align="right">Ind_listen&lt;/th>
&lt;th align="right">Ind_speak&lt;/th>
&lt;th align="right">SEA_listen&lt;/th>
&lt;th align="right">SEA_speak&lt;/th>
&lt;th align="right">Eng_listen&lt;/th>
&lt;th align="right">Eng_speak&lt;/th>
&lt;th align="left">first_lang&lt;/th>
&lt;th align="left">when_Mand&lt;/th>
&lt;th align="left">when_Tw&lt;/th>
&lt;th align="left">when_Hak&lt;/th>
&lt;th align="left">when_Ind&lt;/th>
&lt;th align="left">when_SEA&lt;/th>
&lt;th align="left">when_Eng&lt;/th>
&lt;th align="left">m_guard_identity&lt;/th>
&lt;th align="left">f_guard_identity&lt;/th>
&lt;th align="right">dad_Mand_speak&lt;/th>
&lt;th align="right">dad_Tw_speak&lt;/th>
&lt;th align="right">dad_Hak_speak&lt;/th>
&lt;th align="right">dad_Eng_speak&lt;/th>
&lt;th align="right">dad_Ind_speak&lt;/th>
&lt;th align="right">dad_SEA_speak&lt;/th>
&lt;th align="right">mom_Mand_speak&lt;/th>
&lt;th align="right">mom_Tw_speak&lt;/th>
&lt;th align="right">mom_Hak_speak&lt;/th>
&lt;th align="right">mom_Eng_speak&lt;/th>
&lt;th align="right">mom_Ind_speak&lt;/th>
&lt;th align="right">mom_SEA_speak&lt;/th>
&lt;th align="left">dad_mom_Mand_fq&lt;/th>
&lt;th align="left">dad_mom_Tw_fq&lt;/th>
&lt;th align="left">dad_mom_Hak_fq&lt;/th>
&lt;th align="left">dad_mom_Ind_fq&lt;/th>
&lt;th align="left">dad_mom_SEA_fq&lt;/th>
&lt;th align="left">dad_mom_Other_fq&lt;/th>
&lt;th align="left">me_dad_Mand_fq&lt;/th>
&lt;th align="left">me_dad_Tw_fq&lt;/th>
&lt;th align="left">me_dad_Hak_fq&lt;/th>
&lt;th align="left">me_dad_Ind_fq&lt;/th>
&lt;th align="left">me_dad_SEA_fq&lt;/th>
&lt;th align="left">me_dad_Other_fq&lt;/th>
&lt;th align="left">me_mom_Mand_fq&lt;/th>
&lt;th align="left">me_mom_Tw_fq&lt;/th>
&lt;th align="left">me_mom_Hak_fq&lt;/th>
&lt;th align="left">me_mom_Ind_fq&lt;/th>
&lt;th align="left">me_mom_SEA_fq&lt;/th>
&lt;th align="left">me_mom_Other_fq&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td align="left">2018-06-12&lt;/td>
&lt;td align="left">106&lt;/td>
&lt;td align="right">1996&lt;/td>
&lt;td align="left">是&lt;/td>
&lt;td align="left">428&lt;/td>
&lt;td align="left">女&lt;/td>
&lt;td align="right">56&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="left">大學&lt;/td>
&lt;td align="left">金融業&lt;/td>
&lt;td align="left">10萬以上&lt;/td>
&lt;td align="left">45 - 50 小時&lt;/td>
&lt;td align="left">不具原住民身份&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="left">華語&lt;/td>
&lt;td align="left">7歲前&lt;/td>
&lt;td align="left">7歲前&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">12-15歲&lt;/td>
&lt;td align="left">父親&lt;/td>
&lt;td align="left">母親&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="left">幾乎全用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎全用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">約一半&lt;/td>
&lt;td align="left">多數使用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">2018-06-13&lt;/td>
&lt;td align="left">204&lt;/td>
&lt;td align="right">2004&lt;/td>
&lt;td align="left">是&lt;/td>
&lt;td align="left">204&lt;/td>
&lt;td align="left">女&lt;/td>
&lt;td align="right">57&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="left">碩士&lt;/td>
&lt;td align="left">製造業&lt;/td>
&lt;td align="left">10萬以上&lt;/td>
&lt;td align="left">50 - 55 小時&lt;/td>
&lt;td align="left">不具原住民身份&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="left">華語&lt;/td>
&lt;td align="left">7歲前&lt;/td>
&lt;td align="left">7歲前&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">12-15歲&lt;/td>
&lt;td align="left">父親&lt;/td>
&lt;td align="left">母親&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">多數使用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">多數使用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">多數使用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="left">2018-06-13&lt;/td>
&lt;td align="left">103&lt;/td>
&lt;td align="right">2013&lt;/td>
&lt;td align="left">是&lt;/td>
&lt;td align="left">100&lt;/td>
&lt;td align="left">男&lt;/td>
&lt;td align="right">37&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="left">大學&lt;/td>
&lt;td align="left">金融業&lt;/td>
&lt;td align="left">55,000 - 60,000&lt;/td>
&lt;td align="left">25 - 30 小時&lt;/td>
&lt;td align="left">不具原住民身份&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="left">華語&lt;/td>
&lt;td align="left">7歲前&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">未學會&lt;/td>
&lt;td align="left">7-12歲&lt;/td>
&lt;td align="left">父親&lt;/td>
&lt;td align="left">母親&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="left">幾乎全用&lt;/td>
&lt;td align="left">少數使用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">多數使用&lt;/td>
&lt;td align="left">少數使用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎全用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;td align="left">幾乎不用&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;p>The survey data, &lt;code>data&lt;/code>, contains 22 variables and 267 observations (subjects). I only need these variables below to create the plot I want:&lt;/p>
&lt;ul>
&lt;li>&lt;code>gender&lt;/code>: The gender of the subject&lt;/li>
&lt;li>&lt;code>age&lt;/code>: The age of the subject&lt;/li>
&lt;li>&lt;code>m_guard_identity&lt;/code>: Male guardian of the subject, should be ‘father’ in most cases&lt;/li>
&lt;li>&lt;code>f_guard_identity&lt;/code>: Female guardian of the subject, should be ‘mother’ in most cases&lt;/li>
&lt;li>&lt;code>&amp;lt;lang&amp;gt;_speak&lt;/code>: The subject’s fluency of a language. &lt;code>&amp;lt;lang&amp;gt;&lt;/code> is one of ‘Mand’ (Mandarin), ‘Tw’ (Taiwanese), ‘Hak’ (&lt;a href="https://en.wikipedia.org/wiki/Hakka_Chinese">Hakka&lt;/a>), ‘Ind’ (languages of the indigenous peoples, aka &lt;a href="https://en.wikipedia.org/wiki/Formosan_languages">Formosan languages&lt;/a>, belong to Austronesian languages), ‘SEA’ (languages from South Easth Asia), and ‘Eng’ (English)&lt;/li>
&lt;li>&lt;code>dad_&amp;lt;lang&amp;gt;_speak&lt;/code>: The subject’s male guardian’s fluency of a language. &lt;code>&amp;lt;lang&amp;gt;&lt;/code> is same as above.&lt;/li>
&lt;li>&lt;code>mom_&amp;lt;lang&amp;gt;_speak&lt;/code>: The subject’s female guardian’s fluency of a language. &lt;code>&amp;lt;lang&amp;gt;&lt;/code> is same as above.&lt;/li>
&lt;/ul>
&lt;pre class="language-r">&lt;code class="language-r">&lt;span class="kw">library&lt;/span>(dplyr)
lang &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;#39;Mand&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Tw&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Hak&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Ind&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;SEA&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Eng&amp;#39;&lt;/span>)
cols &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;#39;gender&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;age&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;m_guard_identity&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;f_guard_identity&amp;#39;&lt;/span>,
&lt;span class="kw">paste0&lt;/span>(lang, &lt;span class="st">&amp;#39;_speak&amp;#39;&lt;/span>),
&lt;span class="kw">paste0&lt;/span>(&lt;span class="st">&amp;#39;dad_&amp;#39;&lt;/span>, lang, &lt;span class="st">&amp;#39;_speak&amp;#39;&lt;/span>),
&lt;span class="kw">paste0&lt;/span>(&lt;span class="st">&amp;#39;mom_&amp;#39;&lt;/span>, lang, &lt;span class="st">&amp;#39;_speak&amp;#39;&lt;/span>)
)
data &amp;lt;-&lt;span class="st"> &lt;/span>data[, cols] &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(gender &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;男&amp;#39;&lt;/span> &lt;span class="op">|&lt;/span>&lt;span class="st"> &lt;/span>gender &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;女&amp;#39;&lt;/span>)&lt;/code>&lt;/pre>
&lt;p>Since some content of the survey data is in Chinese, the code below is used to translate it to English:&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">ch2eng &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="cf">function&lt;/span>(x) {
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;男&amp;#39;&lt;/span>) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Male&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;女&amp;#39;&lt;/span>) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Female&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;母親&amp;#39;&lt;/span>) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Mother&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;父親&amp;#39;&lt;/span>) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Father&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;無&amp;#39;&lt;/span>) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;None&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;(外)祖父&amp;#39;&lt;/span>) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Grandpa&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;(外)祖母&amp;#39;&lt;/span>) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Grandma&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">%in%&lt;/span>&lt;span class="st"> &lt;/span>&lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;#39;阿姨&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;嬸嬸&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;舅媽&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;姑姑&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;伯母&amp;#39;&lt;/span>)) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Aunt&amp;#39;&lt;/span>)
&lt;span class="cf">if&lt;/span> (x &lt;span class="op">%in%&lt;/span>&lt;span class="st"> &lt;/span>&lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;#39;叔叔&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;伯伯&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;舅舅&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;姑丈&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;姨丈&amp;#39;&lt;/span>)) &lt;span class="kw">return&lt;/span>(&lt;span class="st">&amp;#39;Uncle&amp;#39;&lt;/span>)
&lt;span class="kw">message&lt;/span>(&lt;span class="st">&amp;#39;No translation found for `&amp;#39;&lt;/span>, x, &lt;span class="st">&amp;#39;`&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;&lt;/span>&lt;span class="ch">\n&lt;/span>&lt;span class="st">&amp;#39;&lt;/span>)
&lt;span class="kw">return&lt;/span>(x)
}
ch2eng_vec &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="cf">function&lt;/span>(vec) {
new_vec &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">vector&lt;/span>(&lt;span class="kw">typeof&lt;/span>(vec), &lt;span class="kw">length&lt;/span>(vec))
&lt;span class="cf">for&lt;/span> (i &lt;span class="cf">in&lt;/span> &lt;span class="kw">seq_along&lt;/span>(vec)) {
new_vec[[i]] &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">ch2eng&lt;/span>(vec[[i]])
}
&lt;span class="kw">return&lt;/span>(new_vec)
}
data &amp;lt;-&lt;span class="st"> &lt;/span>data &lt;span class="op">%&amp;gt;%&lt;/span>&lt;span class="st"> &lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">mutate&lt;/span>(&lt;span class="dt">gender =&lt;/span> &lt;span class="kw">ch2eng_vec&lt;/span>(gender),
&lt;span class="dt">m_guard_identity =&lt;/span> &lt;span class="kw">ch2eng_vec&lt;/span>(m_guard_identity),
&lt;span class="dt">f_guard_identity =&lt;/span> &lt;span class="kw">ch2eng_vec&lt;/span>(f_guard_identity))
&lt;span class="kw">head&lt;/span>(data)&lt;/code>&lt;/pre>
&lt;div class="kable-table">
&lt;table>
&lt;thead>
&lt;tr class="header">
&lt;th align="left">gender&lt;/th>
&lt;th align="right">age&lt;/th>
&lt;th align="left">m_guard_identity&lt;/th>
&lt;th align="left">f_guard_identity&lt;/th>
&lt;th align="right">Mand_speak&lt;/th>
&lt;th align="right">Tw_speak&lt;/th>
&lt;th align="right">Hak_speak&lt;/th>
&lt;th align="right">Ind_speak&lt;/th>
&lt;th align="right">SEA_speak&lt;/th>
&lt;th align="right">Eng_speak&lt;/th>
&lt;th align="right">dad_Mand_speak&lt;/th>
&lt;th align="right">dad_Tw_speak&lt;/th>
&lt;th align="right">dad_Hak_speak&lt;/th>
&lt;th align="right">dad_Ind_speak&lt;/th>
&lt;th align="right">dad_SEA_speak&lt;/th>
&lt;th align="right">dad_Eng_speak&lt;/th>
&lt;th align="right">mom_Mand_speak&lt;/th>
&lt;th align="right">mom_Tw_speak&lt;/th>
&lt;th align="right">mom_Hak_speak&lt;/th>
&lt;th align="right">mom_Ind_speak&lt;/th>
&lt;th align="right">mom_SEA_speak&lt;/th>
&lt;th align="right">mom_Eng_speak&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td align="left">Female&lt;/td>
&lt;td align="right">56&lt;/td>
&lt;td align="left">Father&lt;/td>
&lt;td align="left">Mother&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">Female&lt;/td>
&lt;td align="right">57&lt;/td>
&lt;td align="left">Father&lt;/td>
&lt;td align="left">Mother&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="left">Male&lt;/td>
&lt;td align="right">37&lt;/td>
&lt;td align="left">Father&lt;/td>
&lt;td align="left">Mother&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">2&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">3&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">Female&lt;/td>
&lt;td align="right">44&lt;/td>
&lt;td align="left">Father&lt;/td>
&lt;td align="left">Mother&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="left">Male&lt;/td>
&lt;td align="right">62&lt;/td>
&lt;td align="left">None&lt;/td>
&lt;td align="left">None&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">Female&lt;/td>
&lt;td align="right">56&lt;/td>
&lt;td align="left">Father&lt;/td>
&lt;td align="left">Mother&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">1&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;td align="right">0&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;div id="defining-ethnicity" class="section level4">
&lt;h4>Defining Ethnicity&lt;/h4>
&lt;p>You might notice that there is no variable in the data which explicitly indicates the ethnicity of the subject. To serve the purpose of this survey – visualizing the vitality of languages in a community, ethnicity is defined solely by the linguistics competence of a subject’s guardians.
To give a specific example, let &lt;code>subject A&lt;/code> has a mother who &lt;strong>can speak&lt;/strong>&lt;a href="#fn2" class="footnote-ref" id="fnref2">&lt;sup>2&lt;/sup>&lt;/a> Mandarin and Taiwanese and a father who speaks Mandarin and Hakka, then &lt;code>subject A&lt;/code> is categorized as a Mandarin, a Taiwanese, and a Hakka simultaneously.&lt;/p>
&lt;p>The function &lt;code>filter_ethnic()&lt;/code> is used to filter out subjects with specified ‘ethnicity’. This function is useful for drawing age-sex pyramid for each of the six languages.&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">filter_ethnic &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="cf">function&lt;/span>(df, lang, &lt;span class="dt">lev =&lt;/span> &lt;span class="dv">3&lt;/span>) {
sp_lang &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">vector&lt;/span>(&lt;span class="st">&amp;quot;character&amp;quot;&lt;/span>, &lt;span class="dv">3&lt;/span>)
sp_lang[&lt;span class="dv">1&lt;/span>] &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">paste0&lt;/span>(&lt;span class="st">&amp;quot;dad_&amp;quot;&lt;/span>, lang, &lt;span class="st">&amp;quot;_speak&amp;quot;&lt;/span>)
sp_lang[&lt;span class="dv">2&lt;/span>] &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">paste0&lt;/span>(&lt;span class="st">&amp;quot;mom_&amp;quot;&lt;/span>, lang, &lt;span class="st">&amp;quot;_speak&amp;quot;&lt;/span>)
sp_lang[&lt;span class="dv">3&lt;/span>] &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">paste0&lt;/span>(lang, &lt;span class="st">&amp;quot;_speak&amp;quot;&lt;/span>)
df2 &amp;lt;-&lt;span class="st"> &lt;/span>df &lt;span class="op">%&amp;gt;%&lt;/span>&lt;span class="st"> &lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(m_guard_identity &lt;span class="op">!=&lt;/span>&lt;span class="st"> &amp;#39;None&amp;#39;&lt;/span> &lt;span class="op">|&lt;/span>&lt;span class="st"> &lt;/span>f_guard_identity &lt;span class="op">!=&lt;/span>&lt;span class="st"> &amp;#39;None&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(.data[[sp_lang[&lt;span class="dv">1&lt;/span>]]] &lt;span class="op">&amp;gt;=&lt;/span>&lt;span class="st"> &lt;/span>lev &lt;span class="op">|&lt;/span>&lt;span class="st"> &lt;/span>.data[[sp_lang[&lt;span class="dv">2&lt;/span>]]] &lt;span class="op">&amp;gt;=&lt;/span>&lt;span class="st"> &lt;/span>lev) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">select&lt;/span>(age, gender, sp_lang)
&lt;span class="kw">return&lt;/span>(df2)
}&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div id="assinging-age-group-to-subjects" class="section level3">
&lt;h3>Assinging Age Group to Subjects&lt;/h3>
&lt;p>Remember that the data structure needed for plotting age-sex pyramids requires &lt;strong>age group to be the basic unit&lt;/strong>. &lt;code>data&lt;/code> now consisits of single subjects, and we need information to group subjects together according to their ages. &lt;code>mutate_age_group()&lt;/code> creates a new variable &lt;code>age_group&lt;/code> by the subject’s age.&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">mutate_age_group &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="cf">function&lt;/span>(df, &lt;span class="dt">range =&lt;/span> &lt;span class="dv">5&lt;/span>){
df&lt;span class="op">$&lt;/span>age_group &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">as.character&lt;/span>(
&lt;span class="kw">cut&lt;/span>(df&lt;span class="op">$&lt;/span>age, &lt;span class="dt">right =&lt;/span> F, &lt;span class="dt">breaks =&lt;/span> &lt;span class="kw">seq&lt;/span>(&lt;span class="dv">10&lt;/span>, &lt;span class="dv">95&lt;/span>, &lt;span class="dt">by =&lt;/span> range))
)
&lt;span class="kw">return&lt;/span>(df)
}&lt;/code>&lt;/pre>
&lt;p>&lt;code>cut()&lt;/code> takes a numeric vector as its first input, and codes the values of the vector into new values according to the interval they fall into. In &lt;code>mutate_age_group()&lt;/code>, &lt;code>cut()&lt;/code> codes the input vectors according to the intervals specified in the argument &lt;code>breaks&lt;/code>.&lt;/p>
&lt;p>Now we can use these functions to add more information to the data frame. The idea is to first create a separated data frame for each ethnicity&lt;a href="#fn3" class="footnote-ref" id="fnref3">&lt;sup>3&lt;/sup>&lt;/a> (by &lt;code>filter_ethnic()&lt;/code>), then attact new variables to the data frame that indicate a subject’s ethnicity (&lt;code>ethn_group&lt;/code>) and age group (&lt;code>age_group&lt;/code>).&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">lang &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;#39;Mand&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Tw&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Hak&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Ind&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;SEA&amp;#39;&lt;/span>, &lt;span class="st">&amp;#39;Eng&amp;#39;&lt;/span>)
lev &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">c&lt;/span>(&lt;span class="dv">3&lt;/span>, &lt;span class="dv">3&lt;/span>, &lt;span class="dv">3&lt;/span>, &lt;span class="dv">3&lt;/span>, &lt;span class="dv">3&lt;/span>, &lt;span class="dv">0&lt;/span>)
ethn_list_df &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">vector&lt;/span>(&lt;span class="st">&amp;quot;list&amp;quot;&lt;/span>, &lt;span class="kw">length&lt;/span>(lang))
&lt;span class="cf">for&lt;/span> (i &lt;span class="cf">in&lt;/span> &lt;span class="kw">seq_along&lt;/span>(lang)){
ethn_list_df[[i]] &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">filter_ethnic&lt;/span>(data,
&lt;span class="dt">lang =&lt;/span> lang[i],
&lt;span class="dt">lev =&lt;/span> lev[i]) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">mutate&lt;/span>(&lt;span class="dt">ethn_group =&lt;/span> lang[i]) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">mutate_age_group&lt;/span>() &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">select&lt;/span>(age, gender, age_group, ethn_group,
&lt;span class="kw">paste0&lt;/span>(lang[i], &lt;span class="st">&amp;quot;_speak&amp;quot;&lt;/span>)) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">rename&lt;/span>(&lt;span class="dt">lang_fluency =&lt;/span> &lt;span class="kw">paste0&lt;/span>(lang[i], &lt;span class="st">&amp;quot;_speak&amp;quot;&lt;/span>))
}&lt;/code>&lt;/pre>
&lt;p>Then we can recombine these data frames back to a single one, and this new data frame now has information about a subject’s ethinicity and age group he/she belongs to. (Note that the new data frame is &lt;strong>expended&lt;/strong> since one subject can have several ethnicity, i.e. one subject can appear in different rows of the data frame with different ethnicity.)&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">&lt;span class="kw">bind_rows&lt;/span>(ethn_list_df) &lt;span class="op">%&amp;gt;%&lt;/span>&lt;span class="st"> &lt;/span>&lt;span class="kw">head&lt;/span>()&lt;/code>&lt;/pre>
&lt;div class="kable-table">
&lt;table>
&lt;thead>
&lt;tr class="header">
&lt;th align="right">age&lt;/th>
&lt;th align="left">gender&lt;/th>
&lt;th align="left">age_group&lt;/th>
&lt;th align="left">ethn_group&lt;/th>
&lt;th align="right">lang_fluency&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td align="right">56&lt;/td>
&lt;td align="left">Female&lt;/td>
&lt;td align="left">[55,60)&lt;/td>
&lt;td align="left">Mand&lt;/td>
&lt;td align="right">4&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="right">57&lt;/td>
&lt;td align="left">Female&lt;/td>
&lt;td align="left">[55,60)&lt;/td>
&lt;td align="left">Mand&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="right">37&lt;/td>
&lt;td align="left">Male&lt;/td>
&lt;td align="left">[35,40)&lt;/td>
&lt;td align="left">Mand&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="right">44&lt;/td>
&lt;td align="left">Female&lt;/td>
&lt;td align="left">[40,45)&lt;/td>
&lt;td align="left">Mand&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="right">56&lt;/td>
&lt;td align="left">Female&lt;/td>
&lt;td align="left">[55,60)&lt;/td>
&lt;td align="left">Mand&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="right">53&lt;/td>
&lt;td align="left">Male&lt;/td>
&lt;td align="left">[50,55)&lt;/td>
&lt;td align="left">Mand&lt;/td>
&lt;td align="right">5&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;/div>
&lt;div id="data-for-plotting" class="section level3">
&lt;h3>Data for Plotting&lt;/h3>
&lt;p>Finally, we are ready to group the subjects together according to his/her &lt;code>gender&lt;/code>, &lt;code>ethnicity&lt;/code>, and &lt;code>age_group&lt;/code>. After grouping, we can use &lt;code>dplyr::summarise()&lt;/code> to calculate each group’s fluency of the language, which will be used as the variable on the horizontal axis of the age-sex pyramid.&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">pl_data &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">bind_rows&lt;/span>(ethn_list_df) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">group_by&lt;/span>(gender, ethn_group, age_group) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">summarise&lt;/span>(&lt;span class="kw">mean&lt;/span>(lang_fluency)) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">rename&lt;/span>(&lt;span class="dt">avg_fluency =&lt;/span> &lt;span class="st">`&lt;/span>&lt;span class="dt">mean(lang_fluency)&lt;/span>&lt;span class="st">`&lt;/span>)
&lt;span class="kw">head&lt;/span>(pl_data)&lt;/code>&lt;/pre>
&lt;div class="kable-table">
&lt;table>
&lt;thead>
&lt;tr class="header">
&lt;th align="left">gender&lt;/th>
&lt;th align="left">ethn_group&lt;/th>
&lt;th align="left">age_group&lt;/th>
&lt;th align="right">avg_fluency&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td align="left">Female&lt;/td>
&lt;td align="left">Eng&lt;/td>
&lt;td align="left">[15,20)&lt;/td>
&lt;td align="right">1.750&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">Female&lt;/td>
&lt;td align="left">Eng&lt;/td>
&lt;td align="left">[20,25)&lt;/td>
&lt;td align="right">2.950&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="left">Female&lt;/td>
&lt;td align="left">Eng&lt;/td>
&lt;td align="left">[25,30)&lt;/td>
&lt;td align="right">2.600&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">Female&lt;/td>
&lt;td align="left">Eng&lt;/td>
&lt;td align="left">[30,35)&lt;/td>
&lt;td align="right">3.000&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td align="left">Female&lt;/td>
&lt;td align="left">Eng&lt;/td>
&lt;td align="left">[35,40)&lt;/td>
&lt;td align="right">1.750&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td align="left">Female&lt;/td>
&lt;td align="left">Eng&lt;/td>
&lt;td align="left">[40,45)&lt;/td>
&lt;td align="right">2.125&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;/div>
&lt;div id="plotting-function" class="section level3">
&lt;h3>Plotting Function&lt;/h3>
&lt;p>We are going to draw 6 age-sex pyramids, one for each languages. So instead of writing &lt;code>ggplot()&lt;/code> six times, I wrote a plotting function:&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">&lt;span class="kw">library&lt;/span>(ggplot2)
pl_pyramid &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="cf">function&lt;/span>(data, &lt;span class="dt">title =&lt;/span> &lt;span class="ot">NULL&lt;/span>) {
&lt;span class="kw">ggplot&lt;/span>(data,
&lt;span class="kw">aes&lt;/span>(&lt;span class="dt">x =&lt;/span> age_group,
&lt;span class="dt">y =&lt;/span> &lt;span class="kw">ifelse&lt;/span>(gender &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Male&amp;#39;&lt;/span>, avg_fluency, &lt;span class="op">-&lt;/span>avg_fluency),
&lt;span class="dt">fill =&lt;/span> gender)) &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">geom_bar&lt;/span>(&lt;span class="dt">stat =&lt;/span> &lt;span class="st">&amp;quot;identity&amp;quot;&lt;/span>, &lt;span class="dt">width =&lt;/span> &lt;span class="fl">0.7&lt;/span>) &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">scale_y_continuous&lt;/span>(&lt;span class="dt">limits =&lt;/span> &lt;span class="kw">c&lt;/span>(&lt;span class="op">-&lt;/span>&lt;span class="dv">5&lt;/span>, &lt;span class="dv">5&lt;/span>),
&lt;span class="dt">breaks =&lt;/span> &lt;span class="kw">seq&lt;/span>(&lt;span class="op">-&lt;/span>&lt;span class="dv">5&lt;/span>, &lt;span class="dv">5&lt;/span>, &lt;span class="dv">1&lt;/span>),
&lt;span class="dt">labels =&lt;/span> &lt;span class="kw">abs&lt;/span>(&lt;span class="kw">seq&lt;/span>(&lt;span class="op">-&lt;/span>&lt;span class="dv">5&lt;/span>, &lt;span class="dv">5&lt;/span>, &lt;span class="dv">1&lt;/span>))) &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">coord_flip&lt;/span>() &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">scale_fill_manual&lt;/span>(&lt;span class="dt">values =&lt;/span> &lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;quot;#E41A1C&amp;quot;&lt;/span>, &lt;span class="st">&amp;quot;#377EB8&amp;quot;&lt;/span>),
&lt;span class="dt">breaks =&lt;/span> &lt;span class="kw">c&lt;/span>(&lt;span class="st">&amp;quot;Female&amp;quot;&lt;/span>, &lt;span class="st">&amp;quot;Male&amp;quot;&lt;/span>)) &lt;span class="op">+&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">labs&lt;/span>(&lt;span class="dt">x =&lt;/span> &lt;span class="st">&amp;quot;Age&amp;quot;&lt;/span>, &lt;span class="dt">y =&lt;/span> &lt;span class="st">&amp;quot;Fluency&amp;quot;&lt;/span>, &lt;span class="dt">fill =&lt;/span> &lt;span class="st">&amp;quot;&amp;quot;&lt;/span>, &lt;span class="dt">title =&lt;/span> title)
}&lt;/code>&lt;/pre>
&lt;p>Now we can start plotting. Let’s try &lt;code>Mand&lt;/code> (Mandarin) and &lt;code>Hak&lt;/code> (Hakka) first. We can use &lt;code>dplyr::filter()&lt;/code> to filter out people speaking these languages:&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">tweak &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">theme_bw&lt;/span>() &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">theme&lt;/span>(&lt;span class="dt">axis.text =&lt;/span> &lt;span class="kw">element_text&lt;/span>(&lt;span class="dt">size =&lt;/span> &lt;span class="dv">15&lt;/span>),
&lt;span class="dt">legend.justification =&lt;/span> &lt;span class="st">&amp;quot;right&amp;quot;&lt;/span>,
&lt;span class="dt">legend.position =&lt;/span> &lt;span class="st">&amp;quot;bottom&amp;quot;&lt;/span>,
&lt;span class="dt">legend.box =&lt;/span> &lt;span class="st">&amp;quot;vertical&amp;quot;&lt;/span>)
pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Mand&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>&lt;span class="st"> &lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;Mandarin&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak
pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Ind&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>&lt;span class="st"> &lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;Formosan Languages&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://img.yongfu.name/assets/visualize-language-loss/unnamed-chunk-12-1.svg" width="49%" />&lt;img src="https://img.yongfu.name/assets/visualize-language-loss/unnamed-chunk-12-2.svg" width="49%" />&lt;/p>
&lt;p>Wait! It seems quite strange. The age-sex pyramid of ‘Formosan Languages’ doesn’t look like a pyramid at all!
This is because there were very few subjects defined as ‘indigenous people’ in the survey. To make plots like this (with only one or two age groups) comparable to others (such as that in ‘Mandarin’), we need one more function to &lt;strong>insert missing age groups&lt;/strong> to the data frame so that ggplot can draw empty bars for us.&lt;/p>
&lt;p>First, we need to find out &lt;strong>all age groups in the data&lt;/strong>:&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">age_groups &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">unique&lt;/span>(pl_data&lt;span class="op">$&lt;/span>age_group)
age_groups&lt;/code>&lt;/pre>
&lt;pre>&lt;code class="nohighlight"> [1] &amp;quot;[15,20)&amp;quot; &amp;quot;[20,25)&amp;quot; &amp;quot;[25,30)&amp;quot; &amp;quot;[30,35)&amp;quot; &amp;quot;[35,40)&amp;quot; &amp;quot;[40,45)&amp;quot; &amp;quot;[45,50)&amp;quot;
[8] &amp;quot;[50,55)&amp;quot; &amp;quot;[55,60)&amp;quot; &amp;quot;[60,65)&amp;quot; &amp;quot;[65,70)&amp;quot;&lt;/code>&lt;/pre>
&lt;p>Then we can write a function &lt;code>fill_empty_age_group()&lt;/code>, which takes a data frame as its first argument and checks whether there are age groups missing in the data frame (using its second argument, &lt;code>age_group_all&lt;/code>, as comparison). If the age group is missing, &lt;code>fill_empty_age_group()&lt;/code> appends a new row, which has &lt;code>age_group&lt;/code> set to the missing age group and &lt;code>avg_fluency&lt;/code> set to &lt;code>0&lt;/code> (create an empty bar), to the input data frame.&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">fill_empty_age_group &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="cf">function&lt;/span>(df, age_group_all) {
&lt;span class="cf">for&lt;/span> (i &lt;span class="cf">in&lt;/span> &lt;span class="kw">seq_along&lt;/span>(age_group_all)) {
&lt;span class="cf">if&lt;/span> (&lt;span class="op">!&lt;/span>(age_group_all[i] &lt;span class="op">%in%&lt;/span>&lt;span class="st"> &lt;/span>df&lt;span class="op">$&lt;/span>age_group)) {
df &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">rbind&lt;/span>(df, &lt;span class="kw">list&lt;/span>(&lt;span class="dt">gender =&lt;/span> &lt;span class="st">&amp;quot;Female&amp;quot;&lt;/span>,
&lt;span class="dt">ethn_group =&lt;/span> &lt;span class="st">&amp;quot;doesnt_matter&amp;quot;&lt;/span>,
&lt;span class="dt">age_group =&lt;/span> age_group_all[i],
&lt;span class="dt">avg_fluency =&lt;/span> &lt;span class="dv">0&lt;/span>))
}
}
&lt;span class="kw">return&lt;/span>(df)
}&lt;/code>&lt;/pre>
&lt;p>Now we’re ready to explore language loss in Taiwan. &lt;code>multiplot()&lt;/code> is used to put multiple plots together. The source code of &lt;code>multiplot()&lt;/code> is copied directly from Winston Chang’s &lt;a href="http://www.cookbook-r.com/Graphs/Multiple_graphs_on_one_page_(ggplot2)">Cookbook for R&lt;/a>.&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">tweak2 &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">theme_bw&lt;/span>() &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">theme&lt;/span>(&lt;span class="dt">legend.justification =&lt;/span> &lt;span class="st">&amp;quot;right&amp;quot;&lt;/span>,
&lt;span class="dt">legend.position =&lt;/span> &lt;span class="st">&amp;quot;bottom&amp;quot;&lt;/span>,
&lt;span class="dt">legend.box =&lt;/span> &lt;span class="st">&amp;quot;vertical&amp;quot;&lt;/span>)
py1 &amp;lt;-&lt;span class="st"> &lt;/span>pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Mand&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>&lt;span class="st"> &lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">fill_empty_age_group&lt;/span>(age_groups) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;Mandarin&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak2
py2 &amp;lt;-&lt;span class="st"> &lt;/span>pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Tw&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">fill_empty_age_group&lt;/span>(age_groups) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;Taiwanese&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak2
py3 &amp;lt;-&lt;span class="st"> &lt;/span>pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Hak&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">fill_empty_age_group&lt;/span>(age_groups) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;Hakka&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak2
py4 &amp;lt;-&lt;span class="st"> &lt;/span>pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Ind&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">fill_empty_age_group&lt;/span>(age_groups) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;Formosan Languages&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak2
py5 &amp;lt;-&lt;span class="st"> &lt;/span>pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;SEA&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">fill_empty_age_group&lt;/span>(age_groups) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;Languages of South East Asia&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak2
py6 &amp;lt;-&lt;span class="st"> &lt;/span>pl_data &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">filter&lt;/span>(ethn_group &lt;span class="op">==&lt;/span>&lt;span class="st"> &amp;#39;Eng&amp;#39;&lt;/span>) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">fill_empty_age_group&lt;/span>(age_groups) &lt;span class="op">%&amp;gt;%&lt;/span>
&lt;span class="st"> &lt;/span>&lt;span class="kw">pl_pyramid&lt;/span>(&lt;span class="dt">title =&lt;/span> &lt;span class="st">&amp;#39;English&amp;#39;&lt;/span>) &lt;span class="op">+&lt;/span>&lt;span class="st"> &lt;/span>tweak2
&lt;span class="kw">multiplot&lt;/span>(py1, py2, py3, py4, py5, py6, &lt;span class="dt">cols =&lt;/span> &lt;span class="dv">2&lt;/span>)&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://img.yongfu.name/assets/visualize-language-loss/unnamed-chunk-16-1.svg" width="100%" />&lt;/p>
&lt;/div>
&lt;/div>
&lt;div id="language-loss-in-taiwan" class="section level2">
&lt;h2>Language Loss in Taiwan&lt;/h2>
&lt;p>As described in &lt;a href="#age-sex-pyramid-of-language">Age-Sex Pyramid of Language&lt;/a> above, we can learn about a language’s vitality in Taiwan from the age-sex pyramids drawn above.&lt;/p>
&lt;p>For Formosan and South East Asian languages, there are too few data, and we can’t learn much about these languages from the plots. For Mandarin, the shape of the pyramid is rectangular, indicating the linguistic competence of Mandarin is stable across people of all ages. This is expected as Mandarin, in Taiwan, is the most prevalent language, and most people use it as the primary language in workplace and home.&lt;/p>
&lt;p>Pyramids of Taiwanese and Hakka have inverted trianglular shapes, indicating lower linguistic competence among yonger people. Indeed, it’s not uncommmon to see the fathers and mothers talk to their children in Mandarin but talk to their parents in Taiwanese. Taiwanese is the second prevalent language in Taiwan, but it is shrinking, particularly among young people. Hakka ranks third in prevalence. It faces similar situation to Taiwanese but the situation is even worse, since the usage of Hakka is mostly restricted to Hakka people whereas usage of Taiwanese is not restricted to particular groups of people (many indigenous and Hakka peoples speak fluent Taiwanese).&lt;/p>
&lt;p>English has a special status in Taiwan. It is not a native tongue to people born and raised in Taiwan, but many people know at least a little English. This is because formal education and the (awareness of) globalization lead parents to place importance on English education of their children. This also gives the age-sex pyramid of English its appearance – a triangular shape with wider bottom than top. English is the only language that is growing in Taiwan and, arguably, the language with the strongest vitality. &lt;a href="#tab:tw-pyramids">Table 1&lt;/a> summarizes the discussion above.&lt;/p>
&lt;table>
&lt;caption>&lt;span id="tab:tw-pyramids">Table 1: &lt;/span> Situations of the four most prevalent languages in Taiwan.&lt;/caption>
&lt;thead>
&lt;tr class="header">
&lt;th>&lt;strong>Vitality of Language&lt;/strong>&lt;/th>
&lt;th>&lt;strong>Shape of Pyramid&lt;/strong>&lt;/th>
&lt;th>&lt;strong>Examples (Taiwan)&lt;/strong>&lt;/th>
&lt;/tr>
&lt;/thead>
&lt;tbody>
&lt;tr class="odd">
&lt;td>Shrinking and Dying&lt;/td>
&lt;td>Inverted Triangle&lt;/td>
&lt;td>Taiwanese, Hakka&lt;/td>
&lt;/tr>
&lt;tr class="even">
&lt;td>Growing&lt;/td>
&lt;td>Triangle&lt;/td>
&lt;td>English&lt;/td>
&lt;/tr>
&lt;tr class="odd">
&lt;td>Stable&lt;/td>
&lt;td>Rectangular Bar&lt;/td>
&lt;td>Mandarin&lt;/td>
&lt;/tr>
&lt;/tbody>
&lt;/table>
&lt;/div>
&lt;div class="footnotes">
&lt;ol>
&lt;li id="fn1">&lt;p>The samples are not representative though, and it might only reflect the situation in Taipei (see the geographical distribution of the samples below). But I think there are still reasons to believe that other locations in Taiwan have similar phenomena.&lt;/p>
&lt;p>&lt;img src="https://twlangsurvey.github.io/out_graph/sample_spatial_distr.gif" title="fig:" alt="geo-distribution of samples" style="width: 43%;display:block; margin-left:auto;margin-right:auto" />&lt;a href="#fnref1" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;li id="fn2">&lt;p>Defined by scoring 3 or above in a self-reported 6-point scale measuring the fluency of a language spoken by the subject’s parents.&lt;a href="#fnref2" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;li id="fn3">&lt;p>For English, different from all other languages, the level used to determine ethnicity is &lt;code>0&lt;/code>, i.e. there is no filtering occuring, and all subjects are used. This is because, in Taiwan (and many other non-English speaking communities as well), English is not related to ethnicity and is strongly related to formal education and job requirements.&lt;a href="#fnref3" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;/ol>
&lt;/div>
&lt;p style="text-align:right;font-size:7px;margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:1px">
Last updated: 2019-04-03
&lt;/p></description><category>Linguistics</category><category>visualization</category><category>Web Page</category><category>Travis-CI</category><category>R</category><category>R-bloggers</category></item><item><title>Inserting “Edit on GitHub” Buttons in a Single R Markdown Document</title><link>https://yongfu.name/2019/02/10/rmd_edit_btn/</link><pubDate>Sun, 10 Feb 2019 00:00:00 +0000</pubDate><guid>https://yongfu.name/2019/02/10/rmd_edit_btn/</guid><description>
&lt;p>As the R Markdown ecosystem becomes larger, users now may encounter situations where they have to make decisions on which output format of R Markdown to use.
One may found &lt;strong>none of the formats suitable&lt;/strong> – the features essential to the output document one wants may scatter across different output formats of R Markdown.&lt;/p>
&lt;p>Here is a real example I encountered. I wanted to create a document that:&lt;/p>
&lt;ol class="example" style="list-style-type: decimal">
&lt;li>supports &lt;a href="https://bookdown.org/yihui/bookdown/markdown-extensions-by-bookdown.html">bookdown syntax&lt;/a>, e.g. text references&lt;/li>
&lt;li>has an “Edit on GitHub” button for every chapter that links to the edit page of the source &lt;code>.Rmd&lt;/code> on GitHub&lt;/li>
&lt;/ol>
&lt;p>The two features above can be obtained easily with bookdown’s default GitBook output format, but one more feature is essential to the document I want:&lt;/p>
&lt;ol start="3" class="example" style="list-style-type: decimal">
&lt;li>A document that supports &lt;a href="https://bookdown.org/yihui/rmarkdown/html-document.html#tabbed-sections">tabbed sections&lt;/a>&lt;a href="#fn1" class="footnote-ref" id="fnref1">&lt;sup>1&lt;/sup>&lt;/a>&lt;/li>
&lt;/ol>
&lt;p>So basically, I wanted &lt;code>bookdown::gitbook&lt;/code> that supports tabbed sections, shown in Fig. &lt;a href="#fig:gitbook">1&lt;/a>. However, it’s not possible. This is a feature unique to &lt;code>rmarkdown::html_document&lt;/code>, &lt;a href="https://github.com/rstudio/bookdown/issues/393">not &lt;code>bookdown::gitbook&lt;/code>&lt;/a>.&lt;/p>
&lt;div class="figure">&lt;span id="fig:gitbook">&lt;/span>
&lt;img src="https://yongfu.name/post_source/rmd_edit_btn/book_tabset.png" alt="`bookdown::gitbook` supports tabbed sections? This is just a fake figure." width="100%" />
&lt;p class="caption">
Figure 1: &lt;code>bookdown::gitbook&lt;/code> supports tabbed sections? This is just a fake figure.
&lt;/p>
&lt;/div>
&lt;p>Now I have to find a way, not provided by the default output formats of R Markdown, to create a document with the above three features.
My first thought was to find out how to add the tabbed sections feature to &lt;code>bookdown::gitbook&lt;/code> via JavaScript, but since I’m not familiar with JS, I gave up JavaScript and decided to use the “&lt;strong>native&lt;/strong>” R Markdown approach.
I turned to &lt;code>bookdown::html_document2&lt;/code>, which is based on &lt;code>rmarkdown::html_document&lt;/code> (supports tabbed sections).&lt;/p>
&lt;p>The &lt;a href="https://github.com/liao961120/parallelCode">source repo of my document&lt;/a> is a bookdown project, which has &lt;strong>several &lt;code>.Rmd&lt;/code> files&lt;/strong>.
Each &lt;code>.Rmd&lt;/code> file starts with a level-one heading and defines a single chapter. Since I wanted tabbed sections from &lt;code>rmarkdown::html_document&lt;/code>, I have to use &lt;code>bookdown::html_document2&lt;/code> as the output format, which creates a single HTML output file.&lt;/p>
&lt;div id="adding-to-level-one-headings" class="section level2">
&lt;h2>Adding &lt;img src='https://bit.ly/2RRirG7' alt='fa-edit' style='display:inline-block;height:1em;width:auto;margin-bottom:0'> to Level-one Headings&lt;/h2>
&lt;p>Setting &lt;code>bookdown::html_document2&lt;/code> as the output format creates a single document output (as opposed to &lt;code>bookdown::gitbook&lt;/code> which creates several HTML files by default),
so if I want to add an “Edit on GitHub” button for every chapter, I have to track the &lt;strong>original &lt;code>.Rmd&lt;/code> that generates the particular chapter&lt;/strong>.&lt;/p>
&lt;div id="merge-and-knit-vs.-knit-and-merge" class="section level3">
&lt;h3>“Merge and Knit” vs. “Knit and Merge”&lt;/h3>
&lt;p>There are &lt;a href="https://bookdown.org/yihui/bookdown/new-session.html">two rendering approaches&lt;/a> in bookdown. The default is &lt;strong>Merge and Knit&lt;/strong>, which combines all source &lt;code>.Rmd&lt;/code> files into one single &lt;code>.Rmd&lt;/code> file &lt;strong>then&lt;/strong> knits the document.
In this case, it would be impossible to track the source &lt;code>.Rmd&lt;/code> file for each chapter (unless I create a lookup table manually).&lt;/p>
&lt;p>I can track the source &lt;code>.Rmd&lt;/code> files easily, however, if the document is rendered using the &lt;strong>Knit and Merge&lt;/strong> approach. When using the &lt;strong>Knit and Merge&lt;/strong> approach, the code chunks in the source &lt;code>.Rmd&lt;/code> files are run and the results embedded &lt;strong>before&lt;/strong> the documents get combined together in a single output file. This mean that I can retrieve the source &lt;code>.Rmd&lt;/code> file name while knitting the file (by &lt;code>knitr::current_input()&lt;/code>). This gives me all I need to create the link to the edit page of the &lt;code>.Rmd&lt;/code> source file on GitHub.&lt;/p>
&lt;/div>
&lt;div id="bookdownyml" class="section level3">
&lt;h3>Setting up: &lt;code>_bookdown.yml&lt;/code>&lt;/h3>
&lt;p>To switch from the default “&lt;strong>Merge and Knit&lt;/strong>” to “&lt;strong>Knit and Merge&lt;/strong>”, set &lt;code>new_session: yes&lt;/code> in &lt;code>_bookdown.yml&lt;/code>:&lt;/p>
&lt;pre class="language-yaml">&lt;code class="language-yaml">&lt;span class="fu">new_session:&lt;/span>&lt;span class="at"> yes&lt;/span>
&lt;span class="fu">before_chapter_script:&lt;/span>&lt;span class="at"> &lt;/span>&lt;span class="st">&amp;#39;addons/pre_chap.R&amp;#39;&lt;/span>&lt;/code>&lt;/pre>
&lt;/div>
&lt;div id="setting-up-addonspre_chap.r" class="section level3">
&lt;h3>Setting up: &lt;code>addons/pre_chap.R&lt;/code>&lt;/h3>
&lt;p>To insert the link to the edit page on GitHub, put &lt;code>`r edit_btn`&lt;/code> (inline R code) at the end of the h1 heading of each &lt;code>.Rmd&lt;/code> file, for &lt;a href="https://github.com/liao961120/parallelCode/blob/4ea55dba03feef91ecf12e1014000fedabcc184b/00-functional_programming.Rmd#L1">example&lt;/a>:&lt;/p>
&lt;pre class="language-markdown">&lt;code class="language-markdown">&lt;span class="fu"># Function Factories `r edit_btn`&lt;/span>&lt;/code>&lt;/pre>
&lt;p>&lt;code>edit_btn&lt;/code> is a string variable holding the link&lt;a href="#fn2" class="footnote-ref" id="fnref2">&lt;sup>2&lt;/sup>&lt;/a> to GitHub. It is computed in the R script &lt;code>addons/pre_chap.R&lt;/code>, which is run every time before knitting a &lt;code>.Rmd&lt;/code> file:&lt;/p>
&lt;pre class="language-r">&lt;code class="language-r">url &amp;lt;-&lt;span class="st"> &amp;#39;https://github.com/liao961120/parallelCode/edit/master/&amp;#39;&lt;/span>
gh_edit_path &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">paste0&lt;/span>(url, knitr&lt;span class="op">::&lt;/span>&lt;span class="kw">current_input&lt;/span>())
edit_btn &amp;lt;-&lt;span class="st"> &lt;/span>&lt;span class="kw">paste0&lt;/span>(&lt;span class="st">&amp;#39;&amp;lt;a href=&amp;quot;&amp;#39;&lt;/span>, gh_edit_path, &lt;span class="st">&amp;#39;&amp;quot;&amp;gt;&amp;#39;&lt;/span>,
&lt;span class="st">&amp;#39;&amp;lt;img src=&amp;quot;https://bit.ly/2RRirG7&amp;quot; &amp;#39;&lt;/span>,
&lt;span class="st">&amp;#39;alt=&amp;quot;fa-edit&amp;quot; &amp;#39;&lt;/span>,
&lt;span class="st">&amp;#39;class=&amp;quot;edit&amp;quot;&amp;gt;&amp;lt;/a&amp;gt;&amp;#39;&lt;/span>)&lt;/code>&lt;/pre>
&lt;p>To make &lt;code>addons/pre_chap.R&lt;/code> run every time before knitting a &lt;code>.Rmd&lt;/code> file, include it in the &lt;code>before_chapter_script&lt;/code> field in &lt;code>_bookdown.yml&lt;/code>, as shown in the section, &lt;a href="#bookdownyml">Setting up: &lt;code>_bookdown.yml&lt;/code>&lt;/a>, above.&lt;/p>
&lt;/div>
&lt;div id="setting-up-_output.yml" class="section level3">
&lt;h3>Setting up: &lt;code>_output.yml&lt;/code>&lt;/h3>
&lt;p>This is the output format I set in &lt;code>_output.yml&lt;/code>:&lt;/p>
&lt;pre class="language-yaml">&lt;code class="language-yaml">&lt;span class="fu">bookdown:&lt;/span>&lt;span class="at">:html_document2:&lt;/span>
&lt;span class="fu">theme:&lt;/span>&lt;span class="at"> readable&lt;/span>
&lt;span class="fu">highlight:&lt;/span>&lt;span class="at"> default&lt;/span>
&lt;span class="fu">toc:&lt;/span>&lt;span class="at"> true&lt;/span>
&lt;span class="fu">toc_depth:&lt;/span>&lt;span class="at"> 2&lt;/span>
&lt;span class="fu">toc_float:&lt;/span>
&lt;span class="fu">collapsed:&lt;/span>&lt;span class="at"> false&lt;/span>
&lt;span class="fu">css:&lt;/span>&lt;span class="at"> addons/style.css&lt;/span>
&lt;span class="fu">self_contained:&lt;/span>&lt;span class="at"> false&lt;/span>&lt;/code>&lt;/pre>
&lt;/div>
&lt;/div>
&lt;div id="path-problems-caused-by-self_contained-false" class="section level2">
&lt;h2>Path Problems Caused by &lt;code>self_contained: false&lt;/code>&lt;/h2>
&lt;p>You may notice that I set &lt;code>self_contained: false&lt;/code> in &lt;code>_output.yml&lt;/code>. This isn’t necessary&lt;a href="#fn3" class="footnote-ref" id="fnref3">&lt;sup>3&lt;/sup>&lt;/a> and it actually makes things a little more complicated, since, when using &lt;code>bookdown::html_document2&lt;/code> as the output format, bookdown generates all its dependencies (CSS, JS libraries, figures, etc) in &lt;code>_bookdown_files&lt;/code> and generates its ouput HTML file in the project root directory but doesn’t move the dependencies and the output HTML to the output directory (defaults to &lt;code>_book&lt;/code>) nor modify the relative path to dependency files in the output HTML. This causes the links in the output HTML to break.&lt;/p>
&lt;p>To fix this, I wrote a &lt;a href="https://github.com/liao961120/parallelCode/blob/master/build.sh">bash script&lt;/a> to move the output files&lt;a href="#fn4" class="footnote-ref" id="fnref4">&lt;sup>4&lt;/sup>&lt;/a> to the correct places:&lt;/p>
&lt;pre class="language-bash">&lt;code class="language-bash">&lt;span class="fu">mv&lt;/span> out.html _bookdown_files/index.html
&lt;span class="kw">[[&lt;/span> &lt;span class="ot">-e&lt;/span> out.rds&lt;span class="kw"> ]]&lt;/span> &lt;span class="kw">&amp;amp;&amp;amp;&lt;/span> &lt;span class="fu">mv&lt;/span> out.rds _bookdown_files/
&lt;span class="fu">cp&lt;/span> -r addons/ _bookdown_files/
&lt;span class="kw">[[&lt;/span> &lt;span class="ot">-d&lt;/span> docs&lt;span class="kw"> ]]&lt;/span> &lt;span class="kw">&amp;amp;&amp;amp;&lt;/span> &lt;span class="fu">rm&lt;/span> -r docs
&lt;span class="fu">mv&lt;/span> _bookdown_files docs&lt;/code>&lt;/pre>
&lt;p>For users who don’t use bash, R can be used instead. Check out &lt;a href="http://theautomatic.net/2018/07/11/manipulate-files-r/">this post about file manipulation in R&lt;/a>.&lt;/p>
&lt;/div>
&lt;div class="footnotes">
&lt;ol>
&lt;li id="fn1">&lt;p>The reason I wanted this feature is that I’m writing a document that works like a &lt;a href="https://en.wikipedia.org/wiki/Parallel_text">parallel text&lt;/a>.&lt;/p>
&lt;p>I know three programming languages – R, Bash, and Python, but I’m only familiar with R, struggle with the weird syntax of Bash sometimes (that said, I like Bash pretty much, for its power to do quick and dirty works), and don’t use Python often enough to memorize commonly used syntax.&lt;/p>
&lt;p>By creating a &lt;a href="https://liao961120.github.io/parallelCode">parallel text for R, Bash, and Python&lt;/a>, I can write down the code to deal with some common tasks in these three langauges, so I don’t have to look it up on google every time I forgot the syntax of the langauge.&lt;/p>
&lt;p>I planned to write this document myself initially. But why not do a little more work to make it convenient for others to contribute to this document? This is why I decided to add an “Edit on GitHub” button at the start of every chapter of the document.&lt;a href="#fnref1" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;li id="fn2">&lt;p>&lt;code>edit_btn&lt;/code> holds a &lt;code>&amp;lt;a&amp;gt;&lt;/code> tag with &lt;code>&amp;lt;img&amp;gt;&lt;/code> tag in it. The style of &lt;code>img.edit&lt;/code> is defined in &lt;a href="https://github.com/liao961120/parallelCode/blob/907a6c760e7b447bdd12074db785d89455e4009d/addons/style.css#L59-L69">&lt;code>addons/style.css&lt;/code>&lt;/a>. I didn’t use &lt;a href="https://fontawesome.com">fontawesome&lt;/a> for the edit icon &lt;img src='https://bit.ly/2RRirG7' alt='fa-edit' style='display:inline-block;height: 1em;width:auto;margin-bottom:0'>, since &lt;code>bookdown::html_document2&lt;/code> doesn’t support it and I don’t want to introduce another dependency. I use &lt;code>&amp;lt;img&amp;gt;&lt;/code> tag to source the edit icon from &lt;a href="https://commons.wikimedia.org/wiki/File:Edit_font_awesome.svg">wikimedia&lt;/a> instead.&lt;a href="#fnref2" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;li id="fn3">&lt;p>I set &lt;code>self_contained&lt;/code> to &lt;code>false&lt;/code> because I didn’t want a large output file that takes too much time to load in the browser.&lt;a href="#fnref3" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;li id="fn4">&lt;p>Note that I changed some default filenames by adding some lines in &lt;code>_bookdown.yml&lt;/code>:&lt;/p>
&lt;pre class="language-yaml">&lt;code class="language-yaml">&lt;span class="fu">book_filename:&lt;/span>&lt;span class="at"> &lt;/span>&lt;span class="st">&amp;quot;out&amp;quot;&lt;/span>&lt;span class="er"> # output HTML filename&lt;/span>
&lt;span class="fu">output_dir:&lt;/span>&lt;span class="at"> &lt;/span>&lt;span class="st">&amp;quot;docs&amp;quot;&lt;/span>&lt;span class="er"> # output dir, defaults to `_book`&lt;/span>&lt;/code>&lt;/pre>
&lt;a href="#fnref4" class="footnote-back">↩&lt;/a>&lt;/li>
&lt;/ol>
&lt;/div>
&lt;p style="text-align:right;font-size:7px;margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:1px">
Last updated: 2019-02-10
&lt;/p></description><category>R</category><category>R Markdown</category><category>R-bloggers</category></item><item><title>Using Travis-CI to Create R-bloggers for Taiwan</title><link>https://yongfu.name/2019/01/30/recreate-rbloggers/</link><pubDate>Wed, 30 Jan 2019 00:00:00 +0000</pubDate><guid>https://yongfu.name/2019/01/30/recreate-rbloggers/</guid><description>&lt;p>&lt;a href="https://www.r-bloggers.com">R-bloggers.com&lt;/a> is a great platform for R users, but I sometimes feel awkward to publish posts on R-bloggers when I have things to share that are only relevant to users in Taiwan&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>. Inspired by R-bloggers, I thought maybe I could use &lt;a href="https://travis-ci.org">Travis-CI&lt;/a> and GitHub to create a blog that automatically updates its posts by retrieving them from submitted RSS feeds, just like R-bloggers.&lt;/p>
&lt;h2 id="r-bloggers-for-taiwan">R-bloggers for Taiwan&lt;/h2>
&lt;p>The name of the blog I created is &amp;ldquo;&lt;a href="https://rbloggers.github.io">R部落客&lt;/a>&amp;rdquo;, which is &lt;em>R-bloggers&lt;/em> literally in traditional Chinese.&lt;/p>
&lt;p>The blog is served using GitHub Pages and is hosted under the organization, &lt;a href="https://github.com/Rbloggers">Rbloggers&lt;/a>, on GitHub. To make the platform work, there are three repositories created &amp;ndash; &lt;a href="https://github.com/Rbloggers/RSSparser">RSSparser&lt;/a>, &lt;a href="https://github.com/Rbloggers/Rbloggers.github.io">Rbloggers.github.io&lt;/a>, and &lt;a href="https://github.com/Rbloggers/facebook-publish">facebook-publish&lt;/a>, all integrated with Travis-CI.
I set up a daily &lt;a href="https://docs.travis-ci.com/user/cron-jobs">cron job&lt;/a> to run on &lt;strong>RSSparser&lt;/strong> repo, which generates JSON files to be used for creating new posts.
After finishing the build, Travis-CI pushes the JSON files to &lt;code>gh-pages&lt;/code> branch of &lt;strong>RSSparser&lt;/strong> and triggers a build (using &lt;a href="https://docs.travis-ci.com/user/triggering-builds/">Travis-CI API&lt;/a>) to run on &lt;strong>Rbloggers.github.io&lt;/strong> repo.
The build on &lt;strong>Rbloggers.github.io&lt;/strong> then writes new posts by retrieving the JSON files saved on branch &lt;code>gh-pages&lt;/code> of &lt;strong>RSSparser&lt;/strong>.
Another build is also triggered to run on &lt;strong>facebook-publish&lt;/strong> by the build on &lt;strong>Rbloggers.github.io&lt;/strong>, which shares the new posts created in &lt;strong>Rbloggers.github.io&lt;/strong> on Facebook (using &lt;a href="https://developers.facebook.com/docs/pages/publishing">Facebook API&lt;/a>).&lt;/p>
&lt;p>I learned about the capabilities of Travis-CI in the &lt;a href="https://bookdown.org/yihui/bookdown/github.html">bookdown book&lt;/a> and the &lt;a href="https://bookdown.org/yihui/blogdown/travis-github.html">blogdown book&lt;/a>. Although not directly related to R, I think most R users will benefit a lot by if they know how to use Travis-CI.&lt;/p>
&lt;h2 id="looking-for-r-bloggers--users-from-taiwan">Looking for R Bloggers &amp;amp; Users from Taiwan&lt;/h2>
&lt;p>Currently, &lt;a href="https://rbloggers.github.io">R部落客&lt;/a> is in its infancy and needs support. We are looking for R users and bloggers who read and write in traditional Chinese.&lt;/p>
&lt;ul>
&lt;li>
&lt;p>If you are an R user, you can follow &lt;strong>R部落客&lt;/strong> via &lt;a href="https://www.facebook.com/twRblogger">Facebook fan page&lt;/a>.&lt;/p>
&lt;/li>
&lt;li>
&lt;p>If you write blog posts about R in traditional Chinese, I believe &lt;strong>R部落客&lt;/strong> will be a great platform to advertise your work. You can read more about joining &lt;strong>R部落客&lt;/strong> &lt;a href="https://rbloggers.github.io/join.html">here&lt;/a>.&lt;/p>
&lt;/li>
&lt;/ul>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>Such as a new R package about &lt;a href="https://en.wikipedia.org/wiki/PTT_Bulletin_Board_System">批踢踢&lt;/a>, how to painlessly knit Chinese R Markdown documents to PDF, and how to perform Chinese word segmentation in R etc.&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description><category>Travis-CI</category><category>R-bloggers</category></item><item><title>Customizing Hugo / Blogdown RSS Templates</title><link>https://yongfu.name/2018/12/13/hugo_rss/</link><pubDate>Thu, 13 Dec 2018 00:00:00 +0000</pubDate><guid>https://yongfu.name/2018/12/13/hugo_rss/</guid><description>&lt;p>&lt;a href="https://github.com/rstudio/blogdown">Blogdown&lt;/a> makes it easy to create Hugo blogs or personal websites, and it is becoming more and more popular in the R community. Once the blog is created, people might want to submit their blogs&amp;rsquo; RSS feeds to &lt;a href="https://www.r-bloggers.com/">R-bloggers&lt;/a>. But before that can happen, one must modify the RSS template to meet the &lt;a href="https://www.r-bloggers.com/add-your-blog/">requirements&lt;/a> of RSS submission.&lt;/p>
&lt;p>Due to my successful experience in &lt;a href="https://yongfu.name/2018/08/02/rblogger-criteria.html">creating a new Jekyll RSS template&lt;/a> for my blog, I thought it would be easy to customize the RSS template of Hugo blogs to make it suitable for &lt;strong>R-bloggers&lt;/strong>. &lt;em>I was WRONG&lt;/em>. Hugo has stricter rules for modifying RSS templates&lt;sup id="fnref:1">&lt;a href="#fn:1" class="footnote-ref" role="doc-noteref">1&lt;/a>&lt;/sup>, and it took me a while to figure out how to modify the &lt;strong>category/tag RSS templates&lt;/strong>.&lt;/p>
&lt;p>By default, Hugo generates different RSS feeds for each section and taxonomy&lt;sup id="fnref:2">&lt;a href="#fn:2" class="footnote-ref" role="doc-noteref">2&lt;/a>&lt;/sup>. I will write about how to modify &lt;em>a subset of them&lt;/em> to create category- or tag-specific RSS feeds for &lt;strong>R-bloggers&lt;/strong>, i.e, making the &lt;code>&amp;lt;description&amp;gt;&lt;/code> field of the RSS feed display &lt;strong>full content&lt;/strong>, rather than an excerpt, of a post.&lt;/p>
&lt;h2 id="overwriting-the-default-rss-template">Overwriting the default RSS Template&lt;/h2>
&lt;p>You won&amp;rsquo;t find any RSS template files shipped with Hugo themes (at least &lt;a href="https://github.com/gcushen/hugo-academic">Hugo Acadimic theme&lt;/a> doesn&amp;rsquo;t). RSS files (&lt;code>index.xml&lt;/code>) will be generated (in &lt;code>public/&lt;/code>) according to the default RSS template.&lt;/p>
&lt;p>To override the default RSS template &lt;strong>without touching the theme template&lt;/strong>,&lt;/p>
&lt;ol>
&lt;li>
&lt;p>Copy the &lt;a href="https://gohugo.io/templates/rss/#the-embedded-rss-xml">default RSS template&lt;/a>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Change &lt;code>&amp;lt;description&amp;gt;{% raw %}{{ .Summary | html }}{% endraw %}&amp;lt;/description&amp;gt;&lt;/code> to &lt;code>&amp;lt;description&amp;gt;{% raw %}{{ .Content | html }}{% endraw %}&amp;lt;/description&amp;gt;&lt;/code>&lt;/p>
&lt;/li>
&lt;li>
&lt;p>Create subdirectories in &lt;code>layouts/&lt;/code> and save the RSS template files (name them &lt;code>rss.xml&lt;/code>) in them (one for each subdirectory).&lt;/p>
&lt;/li>
&lt;/ol>
&lt;p>Putting RSS templates in different subdirectories will have effects on different kind of RSS feeds. The file name (e.g. &lt;code>rss.xml&lt;/code>) of the template also matters and can&amp;rsquo;t be arbitrary. Read Hugo&amp;rsquo;s documentation on &lt;a href="https://gohugo.io/templates/rss/#lookup-order-for-rss-templates">Lookup Order for RSS Templates&lt;/a> for details&lt;sup id="fnref:3">&lt;a href="#fn:3" class="footnote-ref" role="doc-noteref">3&lt;/a>&lt;/sup>.&lt;/p>
&lt;h2 id="an-example-hugo-acadimic-theme">An Example: Hugo Acadimic Theme&lt;/h2>
&lt;p>I use &lt;a href="https://github.com/gcushen/hugo-academic">Hugo Acadimic theme&lt;/a> as an example to set two kinds of RSS templates:&lt;/p>
&lt;ol>
&lt;li>
&lt;p>A template that causes &lt;strong>RSS feeds under every category&lt;/strong> to display &lt;em>full content&lt;/em> of the posts&lt;/p>
&lt;ul>
&lt;li>Browse &lt;a href="https://liao961120.github.io/Hugo-RSS/categories/r/index.xml">RSS feed&lt;/a>&lt;/li>
&lt;li>GitHub source: &lt;a href="https://github.com/liao961120/Hugo-RSS/blob/master/layouts/categories/rss.xml">layouts/categories/rss.xml&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;li>
&lt;p>A template with &lt;code>&amp;lt;category&amp;gt;&lt;/code> fields to capture all &lt;em>post tags&lt;/em>&lt;/p>
&lt;ul>
&lt;li>Browse &lt;a href="https://liao961120.github.io/Hugo-RSS/post/index.xml">RSS feed&lt;/a>&lt;/li>
&lt;li>GitHub source: &lt;a href="https://github.com/liao961120/Hugo-RSS/blob/master/layouts/post/rss.xml">layouts/post/rss.xml&lt;/a>&lt;/li>
&lt;/ul>
&lt;/li>
&lt;/ol>
&lt;h3 id="directory-tree">Directory Tree&lt;/h3>
&lt;p>Below is the directory structure (simplified) after adding RSS templates to &lt;strong>Hugo Acadimic theme&lt;/strong>. I added and modified &lt;code>rss.xml&lt;/code> in &lt;code>/layouts/post/&lt;/code> and &lt;code>/layouts/categories/&lt;/code>. Then &lt;code>/docs/post/index.xml&lt;/code> and &lt;code>/docs/categories/&lt;b>r&lt;/b>/index.xml&lt;/code> get generated according to &lt;code>/layouts/post/rss.xml&lt;/code> and &lt;code>/layouts/categories/rss.xml&lt;/code>, respectively.&lt;/p>
&lt;p>Note that &lt;code>/docs&lt;/code> is &lt;code>/public&lt;/code> by default, when &lt;code>publishDir = &amp;quot;docs&amp;quot;&lt;/code> is not set in &lt;code>/config.toml&lt;/code>. Using &lt;code>/docs&lt;/code> allows me to &lt;a href="https://gohugo.io/hosting-and-deployment/hosting-on-github/">publish Hugo blog on GitHub Pages&lt;/a>. &lt;strong>DO NOT add &lt;code>publishDir = &amp;quot;docs&amp;quot;&lt;/code> in &lt;code>config.toml&lt;/code> if you&amp;rsquo;re serving the site with netlify&lt;/strong>.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;">&lt;code class="language-yaml" data-lang="yaml">&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 1&lt;/span>&lt;span>&lt;span style="color:#ae81ff">/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 2&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── index.Rmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 3&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── Hugo-RSS.Rproj&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 4&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── config.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 5&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── content/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 6&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   ├── home/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 7&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   └── post/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 8&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│      ├── 2015-07-23-r-rmarkdown.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f"> 9&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│      └── 2015-07-23-r-rmarkdown.Rmd&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">10&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">11&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── layouts/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">12&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   ├── post/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">13&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   │   └── rss.xml &lt;/span> &lt;span style="color:#75715e"># Add/Modify RSS template here&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">14&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   └── categories/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">15&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│      └── rss.xml &lt;/span> &lt;span style="color:#75715e"># Add/Modify RSS template here&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">16&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">17&lt;/span>&lt;span>&lt;span style="color:#ae81ff">├── docs/ &lt;/span> &lt;span style="color:#75715e"># change &amp;#39;public&amp;#39; to &amp;#39;docs&amp;#39; in /config.toml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">18&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   ├── index.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">19&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   ├── index.xml&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">20&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   ├── home/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">21&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   ├── post/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">22&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   │   ├── index.xml &lt;/span> &lt;span style="color:#75715e"># set in &amp;#39;/layouts/post/rss.xml&amp;#39; &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">23&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   │   ├── index.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">24&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   │   ├── 2015-07-23-r-rmarkdown/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">25&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   │   └── 2015-07-23-r-rmarkdown_files/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">26&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│   └── categories/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">27&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│      └── r/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">28&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│      ├── index.xml &lt;/span> &lt;span style="color:#75715e"># set in &amp;#39;/layouts/categories/rss.xml&amp;#39; &lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">29&lt;/span>&lt;span>&lt;span style="color:#ae81ff">│      └── index.html&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">30&lt;/span>&lt;span>&lt;span style="color:#ae81ff">└── themes/&lt;/span>
&lt;/span>&lt;/span>&lt;span style="display:flex;">&lt;span style="white-space:pre;user-select:none;margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#7f7f7f">31&lt;/span>&lt;span> &lt;span style="color:#ae81ff">└── hugo-academic/&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;h3 id="source-code">Source Code&lt;/h3>
&lt;p>You can check out the complete directory at &lt;a href="https://github.com/liao961120/Hugo-RSS">GitHub&lt;/a> and the &lt;a href="https://liao961120.github.io/Hugo-RSS/">web page&lt;/a> generated from this repo.&lt;/p>
&lt;div class="footnotes" role="doc-endnotes">
&lt;hr>
&lt;ol>
&lt;li id="fn:1">
&lt;p>For Jekyll blogs, creating a new RSS feed is just like creating a new page in the blog, and one can even use custom file names for RSS template files (such as &lt;a href="https://github.com/liao961120/blog/blob/master/feed.rbloggers.xml">feed.rbloggers.xml&lt;/a>).&amp;#160;&lt;a href="#fnref:1" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:2">
&lt;p>See &lt;a href="https://gohugo.io/templates/rss/">https://gohugo.io/templates/rss/&lt;/a> for more information.&amp;#160;&lt;a href="#fnref:2" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;li id="fn:3">
&lt;p>I have to admit that I don&amp;rsquo;t completely understand Hugo&amp;rsquo;s RSS template look up order. I can&amp;rsquo;t predict the behaviors of Hugo precisely.&amp;#160;&lt;a href="#fnref:3" class="footnote-backref" role="doc-backlink">&amp;#x21a9;&amp;#xfe0e;&lt;/a>&lt;/p>
&lt;/li>
&lt;/ol>
&lt;/div></description><category>Web Page</category><category>blogdown</category><category>R-bloggers</category></item><item><title>Create a Glossary in R Markdown</title><link>https://yongfu.name/2018/10/24/glossary-maker/</link><pubDate>Wed, 24 Oct 2018 00:00:00 +0000</pubDate><guid>https://yongfu.name/2018/10/24/glossary-maker/</guid><description>
&lt;p>I was thinking about creating a glossary in &lt;a href="https://bookdown.org/yihui/bookdown/">bookdown&lt;/a> and found out that there was already an &lt;a href="https://github.com/rstudio/bookdown/issues/199">issue&lt;/a> about it. I like Yihui’s &lt;a href="https://github.com/rstudio/bookdown/issues/199#issuecomment-246888361">recommendation&lt;/a>: use Pandoc’s &lt;a href="http://pandoc.org/MANUAL.html#definition-lists">definition lists&lt;/a>. This was exactly what I had been doing, but I quickly found out that there was a major drawback – the definition lists &lt;strong>won’t order alphabetically unless written in that way&lt;/strong>.&lt;/p>
&lt;p>So I wrote an R function to reorder the definition lists written in R Markdown. Note that this functions &lt;strong>only works for R Markdown files containing defintion lists exclusively&lt;/strong>. If the R Markdown files aren’t whole-definition-lists, the function will fail.&lt;/p>
&lt;div id="usage" class="section level2">
&lt;h2>Usage&lt;/h2>
&lt;p>To order the definition lists alphabetically, simply put the Rmd file path in the function. To have a different output file, provide the output file path as the second argument.&lt;/p>
&lt;pre>&lt;code class="r">sort_def_list(&amp;quot;glossary.Rmd&amp;quot;)
# sort_def_list(&amp;quot;glossary.Rmd&amp;quot;, &amp;quot;reordered.Rmd&amp;quot;)&lt;/code>&lt;/pre>
&lt;p>The output in PDF looks like this (I used the &lt;code>multicol&lt;/code> package)&lt;a href="#fn1" class="footnote-ref" id="fnref1">&lt;sup>1&lt;/sup>&lt;/a>:&lt;/p>
&lt;p>&lt;img src="https://raw.githubusercontent.com/liao961120/blog/master/post_source/glossary-maker/glossary.png" />&lt;/p>
&lt;/div>
&lt;div id="source-code" class="section level2">
&lt;h2>Source Code&lt;/h2>
&lt;pre>&lt;code class="r">sort_def_list &amp;lt;- function(in_file, out_file = NULL) {
library(stringr)
library(dplyr)
data &amp;lt;- readLines(in_file)
# Extract, remove yaml header
yaml &amp;lt;- which(data == &amp;quot;---&amp;quot;)
head &amp;lt;- c(data[yaml[1]:yaml[2]], &amp;quot;\n&amp;quot;)
data &amp;lt;- data[(yaml[2]+1):length(data)]
# Indexing lines
def_start &amp;lt;- which(stringr::str_detect(data, &amp;quot;^: &amp;quot;)) - 1
def_end &amp;lt;- c(def_start[2:length(def_start)] - 1, length(data))
def_ranges &amp;lt;- dplyr::data_frame(term = data[def_start],
start = def_start,
end = def_end) %&amp;gt;%
dplyr::arrange(term) %&amp;gt;%
dplyr::mutate(new_start =
cumsum(
c(1, (end-start+1)[-length(term)])
)
) %&amp;gt;%
dplyr::mutate(new_end = new_start + (end-start))
# Create ordered definition list
data2 &amp;lt;- rep(NA, length(data))
for (i in seq_along(def_ranges$term)) {
start &amp;lt;- def_ranges$start[i]
end &amp;lt;- def_ranges$end[i]
n_start &amp;lt;- def_ranges$new_start[i]
n_end &amp;lt;- def_ranges$new_end[i]
data2[n_start:n_end] &amp;lt;- data[start:end]
}
# Rewrite rmd
if (is.null(out_file)) out_file &amp;lt;- in_file
data2 &amp;lt;- c(head, data2[!is.na(data2)])
writeLines(paste(data2, collapse = &amp;quot;\n&amp;quot;),
out_file)
}&lt;/code>&lt;/pre>
&lt;/div>
&lt;div class="footnotes">
&lt;ol>
&lt;li id="fn1">&lt;p>To see the source R Markdown file, visit &lt;a href="https://github.com/liao961120/blog/tree/master/post_source/glossary-maker/glossary.rmd">&lt;code>glossary.rmd&lt;/code>&lt;/a>. To see the output PDF, visit &lt;a href="https://github.com/liao961120/blog/tree/master/post_source/glossary-maker/glossary.pdf">&lt;code>glossary.pdf&lt;/code>&lt;/a>&lt;a href="#fnref1" class="footnote-back">↩︎&lt;/a>&lt;/p>&lt;/li>
&lt;/ol>
&lt;/div>
&lt;p style="text-align:right;font-size:7px;margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:1px">
&lt;a href="https://www.r-bloggers.com/">Visit R-bloggers&lt;/a>&lt;br>
Last updated: 2020-02-13
&lt;/p></description><category>R</category><category>R Markdown</category><category>R-bloggers</category></item><item><title>Easy Linguistics Document Writing with R Markdown</title><link>https://yongfu.name/2018/09/09/linguistics-down/</link><pubDate>Sun, 09 Sep 2018 00:00:00 +0000</pubDate><guid>https://yongfu.name/2018/09/09/linguistics-down/</guid><description>
&lt;p>I’ve written &lt;a href="https://liao961120.github.io/2018/09/06/ipa-symbols.html">a post&lt;/a> about rendering IPA symbols properly regardless of the output format of the R Markdown document. I implemented the ideas into an R package, &lt;strong>linguisticsdown&lt;/strong>. &lt;/p>
&lt;p>&lt;strong>linguisticsdown&lt;/strong> provides a Shiny interface to facilitate inserting IPA symbols in R Markdown. See a quick demo of the current feature of &lt;strong>linguisticsdown&lt;/strong> in the gif at the end of the post.&lt;/p>
&lt;p>A &lt;a href="https://liao961120.shinyapps.io/IPA-Easily-Written/">live demo&lt;/a> is hosted on shinyapps.io. For more details, visit &lt;a href="https://liao961120.github.io/linguisticsdown/">&lt;strong>linguisticsdown&lt;/strong>&lt;/a>.&lt;/p>
&lt;p>&lt;img src="https://liao961120.github.io/linguisticsdown/man/figs/features.gif" />&lt;/p>
&lt;p style="text-align:right;font-size:7px;margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:1px">
Last updated: 2019-03-07
&lt;/p></description><category>Linguistics</category><category>R Markdown</category><category>R</category><category>R-bloggers</category></item><item><title>Rendering IPA Symbols in R Markdown</title><link>https://yongfu.name/2018/09/06/ipa-symbols/</link><pubDate>Thu, 06 Sep 2018 00:00:00 +0000</pubDate><guid>https://yongfu.name/2018/09/06/ipa-symbols/</guid><description>
&lt;p>I was thinking about promoting reproducible research in Linguistics, or more precisely, how to attract people with no programming skills to have incentives to learn at least a bit programming, so that they have the ability to make their research more reproducible. &lt;/p>
&lt;p>I arrived at the solution: start by adopting R Markdown to write articles (see &lt;a href="#obstacles-to-adopting-a-reproducible-workflow">the last section&lt;/a> for details), but making R Markdown more friendly to novices in a particular field of academia is crucial to enhance their incentives to learn programming.&lt;/p>
&lt;div id="tasks-specific-to-linguistics" class="section level2">
&lt;h2>Tasks Specific to Linguistics&lt;/h2>
&lt;p>I came out with some common tasks related to document writing in Linguistics (I will thank you if you tell me other tasks I missed):&lt;/p>
&lt;ol style="list-style-type: decimal">
&lt;li>Typing IPA symbols.&lt;/li>
&lt;li>Drawing syntax trees.&lt;/li>
&lt;/ol>
&lt;p>To enhance R Markdown’s ability to do these tasks without compromising one of it’s great feature: render nicely to both HTML and PDF with the same source, one needs to consider the incompatiblity of LaTeX and HTML code.&lt;/p>
&lt;p>Solving the first problem (IPA symbol) is easy, draing syntax trees is hard and I haven’t have a solution yet&lt;a href="#fn1" class="footnote-ref" id="fnref1">&lt;sup>1&lt;/sup>&lt;/a>.&lt;/p>
&lt;/div>
&lt;div id="typing-ipa-symbols" class="section level2">
&lt;h2>Typing IPA Symbols&lt;/h2>
&lt;p>There are two problems to be solved in order to facilitate using IPA symbols in R Markdown:&lt;/p>
&lt;ol style="list-style-type: decimal">
&lt;li>Input method&lt;/li>
&lt;li>Font support (only related to PDF output)&lt;/li>
&lt;/ol>
&lt;p>The first one is essentially about mapping some combination of keys to unicode strings. This post demenstates how to solve the second, which is more fundamental.&lt;/p>
&lt;p>After doing a little research, I came out with a quick solution which stems from the combination of &lt;a href="http://www.languagebits.com/phonetics-english/ipa-symbols-in-r/">IPA Symbols in R&lt;/a>, &lt;a href="https://tex.stackexchange.com/questions/25249/how-do-i-use-a-particular-font-for-a-small-section-of-text-in-my-document">How do I use a particular font for a small section of text in my document?&lt;/a>, and &lt;a href="https://github.com/rstudio/bookdown/issues/168">Conditional compilation of book chunks to ensure compatibility with both HTML and XeLaTeX&lt;/a>.&lt;/p>
&lt;p>The solution is very simple: define a new font family that supports IPA symbols in LaTeX and use conditional compilation to render the document: when compiled to HTML, use raw unicode string; when compiled to PDF, wrap LaTeX code around IPA unicode strings.&lt;/p>
&lt;p>To define a new font family for IPA symbols, set &lt;code>header.tex&lt;/code> and include it by setting the yaml header of R Markdown document:&lt;/p>
&lt;pre class="yaml">&lt;code>output:
bookdown::pdf_document2:
includes:
in_header: header.tex&lt;/code>&lt;/pre>
&lt;p>Here’s &lt;code>header.tex&lt;/code>:&lt;/p>
&lt;pre class="latex">&lt;code>% Set font size
\usepackage[fontsize=12pt]{scrextend}
% Set font family
\usepackage{xeCJK}
\usepackage{fontspec}
\setmainfont{Calibri}
\setCJKmainfont[
BoldFont={HanWangHeiHeavy}
]{HanWangHeiLight}
% IPA font
\newfontfamily\ipa{Doulos SIL}
\DeclareTextFontCommand{\ipatext}{\ipa}&lt;/code>&lt;/pre>
&lt;p>The font, &lt;a href="https://software.sil.org/doulos/">Doulos SIL&lt;/a>, which supports IPA symbols can be freely dowloaded.&lt;/p>
&lt;p>The code chunk below is for conditional compilation:&lt;/p>
&lt;pre>&lt;code class="r">ipa &amp;lt;- c('e\u026A', 'a\u026A', '\u0254\u026A')
if (knitr::opts_knit$get('rmarkdown.pandoc.to') == &amp;quot;latex&amp;quot;) {
ipa &amp;lt;- paste0(&amp;quot;\\ipatext{&amp;quot;, ipa, &amp;quot;}&amp;quot;)
}&lt;/code>&lt;/pre>
&lt;p>The IPA symbols are set in the variable &lt;code>ipa&lt;/code> and can be access inline in R Markdown with, e.g., &lt;code>r ipa&lt;/code> or &lt;code>r ipa[3]&lt;/code>, which renders to &lt;strong>eɪ, aɪ, ɔɪ&lt;/strong> and &lt;strong>ɔɪ&lt;/strong>, respectively.&lt;/p>
&lt;p>The source of this post is in my &lt;a href="https://github.com/liao961120/blog/tree/master/post_source/ipa-symbols">GitHub repo&lt;/a>. You can reproduce it locally to see the differnce between HTML and PDF output of this post.&lt;/p>
&lt;/div>
&lt;div id="obstacles-to-adopting-a-reproducible-workflow" class="section level2">
&lt;h2>Obstacles to Adopting a Reproducible Workflow&lt;/h2>
&lt;p>&lt;em>Skip this section if you’re tired of stuff about reproducibility and R Markdown.&lt;/em>&lt;/p>
&lt;p>Reproducible research not only enhance scientific progress but also saves researchers a great deal of time, by automating repetitive and error-prone tasks in research. So if there are good reasons to adopt a reproducible workflow in research, saving time (in the long run) might be a good one.&lt;/p>
&lt;p>Programming skill is fundamental to automating repetitive tasks, which saves one’s time. However, learning programming to save time makes no sense to many people, since it is terrifying, hard, and time consumming&lt;a href="#fn2" class="footnote-ref" id="fnref2">&lt;sup>2&lt;/sup>&lt;/a>. So the problem now becomes:&lt;/p>
&lt;blockquote>
&lt;p>How to reinforce the incentive to learn programming?&lt;/p>
&lt;/blockquote>
&lt;p>Again, by showing people how to save time, but this time, programming skill is not required.&lt;/p>
&lt;p>I think R Markdown is a very promising starting point, since writing is necessary for researcheres, and one can use RStudio without any knowledge of R. When becoming familiar with R Markdown, one begins to adopt a reproducible workflow and might notice the capability of R language, hence gaining more incentive to learn R.&lt;/p>
&lt;p>Many people in academia uses Microsoft Word to write articles and papers. However, R Markdown has several advantages over MS Word:&lt;/p>
&lt;ul>
&lt;li>Easy to inserting images and tables in documents.&lt;/li>
&lt;li>Values of variables (e.g. values in tables or &lt;em>p&lt;/em>-values) are automatically updated when raw data changes.&lt;/li>
&lt;li>Easy citation using citation keys (&lt;a href="https://www.zotero.org/">Zotero&lt;/a> + &lt;a href="https://github.com/retorquere/zotero-better-bibtex">Better BibTeX&lt;/a> greatly facilitates this).&lt;/li>
&lt;li>Mutiple output format, e.g. LaTeX, PDF, Web Page, Book, etc.&lt;/li>
&lt;li>&lt;a href="https://github.com/rstudio/rticles">Template support&lt;/a> for Journel articles, such as Elsevier, Sage, Springer, so no formatting is needed.&lt;/li>
&lt;/ul>
&lt;p>But I think all benefits about R Markdown mentioned above aren’t enough to persuade people into giving up MS Word, since people are conservative in adoping new things.&lt;/p>
&lt;p>If using R Markdown (or R) has benefits specific to the field related to the researcher, it greatly enhances the chance of adopting R Markdown. Hence, if I want to persuade people to use R Markdown, I can first build R packages that enhances the ability of R Markdown in that field.&lt;/p>
&lt;/div>
&lt;div class="footnotes">
&lt;ol>
&lt;li id="fn1">&lt;p>There are LaTeX packages supporting drawing syntax tree, but LaTeX package is not compatible with HTML output.&lt;a href="#fnref1" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;li id="fn2">&lt;p>I actually stared and gave up learning programming languages three times (C++, C, and then Python) before I successfully learned R.&lt;a href="#fnref2" class="footnote-back">↩&lt;/a>&lt;/p>&lt;/li>
&lt;/ol>
&lt;/div>
&lt;p style="text-align:right;font-size:7px;margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:1px">
Last updated: 2019-03-07
&lt;/p></description><category>Linguistics</category><category>R Markdown</category><category>R</category><category>LaTeX</category><category>R-bloggers</category></item><item><title>Making Jekyll Blog Suitable for R-bloggers</title><link>https://yongfu.name/2018/08/02/rblogger-criteria/</link><pubDate>Thu, 02 Aug 2018 00:00:00 +0000</pubDate><guid>https://yongfu.name/2018/08/02/rblogger-criteria/</guid><description>&lt;/p>
&lt;p>Two reasons make it difficult:&lt;/p>
&lt;ol style="list-style-type: decimal">
&lt;li>&lt;blockquote>
&lt;p>The &lt;strong>feed&lt;/strong> you submit &lt;strong>should ONLY be about R&lt;/strong> (e.g: with R code, or directly related to the R world/community).&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>This causes problem because most bloggers write posts spanning several topics, and some blogging platform doesn’t support RSS feed for a particular category of posts.&lt;/li>
&lt;/ul>&lt;/li>
&lt;li>&lt;blockquote>
&lt;p>Make sure the HTML of your feed’s content is well formatted – otherwise it would not be able to load on r-bloggers. This includes to NOT copy-pasting from RStudio’s notebook extension – the feed &lt;strong>should NOT include “base64” images&lt;/strong>, make sure your images are saved as png or similar file formats.&lt;/p>
&lt;/blockquote>
&lt;ul>
&lt;li>For posts written with &lt;a href="https://rmarkdown.rstudio.com">R Markdown&lt;/a> and &lt;a href="https://rmarkdown.rstudio.com/html_fragment_format.html">HTML Fragment&lt;/a> output format, the embedded images generated from code chunks (such as outputs from &lt;code>plot()&lt;/code>) are &lt;strong>base64 images&lt;/strong>.&lt;/li>
&lt;/ul>&lt;/li>
&lt;/ol>
&lt;div id="fixing-the-first-problem" class="section level2">
&lt;h2>Fixing the First Problem&lt;/h2>
&lt;p>For &lt;strong>Jekyll&lt;/strong> sites using &lt;a href="https://github.com/jekyll/jekyll-feed">jekyll-feed&lt;/a> plugin to generate sitemaps, it is not possible to have RSS feed for a particular tag or category of posts. However there’s a workaround using &lt;strong>Jekyll&lt;/strong>’s &lt;a href="https://shopify.github.io/liquid/">Liquid syntax&lt;/a> to write an RSS template, as indicated by &lt;a href="https://devblog.dymel.pl/2017/02/09/category-rss-feed-in-jekyll/">this post&lt;/a>. I modified the template to make it suitable for the criteria set by R-bloggers, you can take a look at the file &lt;a href="https://github.com/liao961120/blog/blob/master/feed.rbloggers.xml">feed.rbloggers.xml&lt;/a>.&lt;/p>
&lt;/div>
&lt;div id="fixing-the-second-problem" class="section level2">
&lt;h2>Fixing the Second Problem&lt;/h2>
&lt;p>To fix the second problem, set &lt;code>self_contained: false&lt;/code> in the yaml header of the R Markdown document. With this setting, plots from code chunks are automatically generated in a figure directory, and the &lt;code>.html&lt;/code> output uses &lt;code>&amp;lt;img&amp;gt;&lt;/code> tags to source the plots in that figure directory.&lt;/p>
&lt;pre class="yaml">&lt;code>---
output:
html_fragment:
self_contained: false
---&lt;/code>&lt;/pre>
&lt;p>However, this creates a problem since the relative path in the &lt;code>&amp;lt;img&amp;gt;&lt;/code> tags probably won’t work in the remote directory that hosts your site. To overcome this problem, you have to &lt;strong>change the default figure directory&lt;/strong> and &lt;strong>post-process the output &lt;code>.html&lt;/code> file&lt;/strong>.&lt;/p>
&lt;p>For example, the source of this post(&lt;code>rblogger-criteria.rmd&lt;/code>) is two layers under the root dir of the web site.&lt;/p>
&lt;pre>&lt;code class="nohighlight">+---assets/
| +---rblogger-criteria-img/
+---_includes/
+---_plugins/
+---_posts/
+---post_source/
| +---rblogger-criteria/
| | +---rblogger-criteria.rmd
| | +---rblogger-criteria.html
+---index.html
+---_config.yml&lt;/code>&lt;/pre>
&lt;p>I set my figure directory to &lt;code>assets/rblogger-criteria-img/&lt;/code>:&lt;/p>
&lt;pre>&lt;code class="r">```{r setup, include=FALSE}
knitr::opts_chunk$set(
fig.path = &amp;quot;../..https://img.yongfu.name/assets/rblogger-criteria-img/&amp;quot;
)
```&lt;/code>&lt;/pre>
&lt;p>so when the site is rendered, the image would be in &lt;code>https://liao961120.github.io/assets/rblogger-criteria-img/&lt;/code>&lt;/p>
&lt;p>The last thing to do is processing the output &lt;code>rblogger-criteria.html&lt;/code> and replacing &lt;code>&amp;lt;img src=&amp;quot;../../assets&lt;/code> with &lt;code>&amp;lt;img src=&amp;quot;/assets&lt;/code> in the &lt;code>&amp;lt;img&amp;gt;&lt;/code> tag. I do this with a simple bash script:&lt;/p>
&lt;pre>&lt;code class="bash">sed &amp;quot;s#&amp;lt;img src=\&amp;quot;../../assets#&amp;lt;img src=\&amp;quot;/assets#g&amp;quot; rblogger-criteria.html &amp;gt; temp
cat temp &amp;gt; rblogger-criteria.html&lt;/code>&lt;/pre>
&lt;/div>
&lt;div id="a-demo" class="section level2">
&lt;h2>A Demo&lt;/h2>
&lt;p>Below is a plot generated from an R Markdown code chunk, you can look at the path in &lt;code>&amp;lt;img&amp;gt;&lt;/code> tag with the developer’s tool or the &lt;a href="https://img.yongfu.name/assets/rblogger-criteria-img/iris-1.png">image source&lt;/a> to confirm the path of the image is just as mentioned above.&lt;/p>
&lt;pre>&lt;code class="r">library(ggplot2)
ggplot(iris, aes(Sepal.Length, Petal.Width)) +
geom_point(aes(color = Species))&lt;/code>&lt;/pre>
&lt;p>&lt;img src="https://img.yongfu.name/assets/rblogger-criteria-img/iris-1.png" width="100%" />&lt;/p>
&lt;/div>
&lt;p style="text-align:right;font-size:7px;margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:1px">
&lt;a href="https://www.r-bloggers.com/">Visit R-bloggers&lt;/a>&lt;br>
Last updated: 2018-11-07
&lt;/p></description><category>R-bloggers</category><category>Jekyll</category><category>R Markdown</category><category>Web Page</category></item><item><title>My Notes on R Markdown</title><link>https://yongfu.name/2018/07/23/rmd_intro/</link><pubDate>Mon, 23 Jul 2018 00:00:00 +0000</pubDate><guid>https://yongfu.name/2018/07/23/rmd_intro/</guid><description>
&lt;p>I’ve used &lt;a href="https://rmarkdown.rstudio.com/">R Markdown&lt;/a> to do lots of work, such as writing a &lt;a href="https://liao961120.github.io/MVA/">book&lt;/a>, doing homework on &lt;a href="https://yongfu.name/notes/106-2/multivariate/">statistics&lt;/a> and &lt;a href="https://yongfu.name/notes/106-2/Eco_model/spatial_model.html">ecology&lt;/a>, and making &lt;a href="https://twlangsurvey.github.io/main/">web pages&lt;/a>. &lt;/p>
&lt;p>The above mentioned are all HTML output formats from R Markdown, but PDF output formats are also possible, such as this &lt;a href="https://yongfu.name/notes/rmd_features.html#12_beamer_slide">Beamer Slide&lt;/a> and an &lt;a href="https://github.com/liao961120/ling-rmd">article about R Markdown&lt;/a>.&lt;/p>
&lt;p>Because of doing so much work with R Markdown, I write down some of the most common and useful features of R Markdown so I can look it up when I need to&lt;a href="#fn1" class="footnoteRef" id="fnref1">&lt;sup>1&lt;/sup>&lt;/a>. I also make it available to everyone by putting the &lt;a href="https://yongfu.name/notes/rmd_features.html">document&lt;/a> on my blog.&lt;/p>
&lt;div id="other-resources-of-r-markdown" class="section level2">
&lt;h2>Other Resources of R Markdown&lt;/h2>
&lt;ul>
&lt;li>&lt;p>&lt;a href="https://bookdown.org/yihui/rmarkdown/">R Markdown: The Definitive Guide&lt;/a>&lt;/p>&lt;/li>
&lt;li>&lt;p>&lt;a href="https://bookdown.org/yihui/bookdown/">Bookdown&lt;/a>&lt;/p>&lt;/li>
&lt;li>&lt;p>&lt;a href="https://www.rstudio.com/wp-content/uploads/2015/02/rmarkdown-cheatsheet.pdf">R Markdown Cheat sheet&lt;/a>&lt;/p>&lt;/li>
&lt;/ul>
&lt;/div>
&lt;div class="footnotes">
&lt;ol>
&lt;li id="fn1">&lt;p>Since it is intended for &lt;strong>quick lookup&lt;/strong>, the document is very compact. That means you need to have some basic knowledge on R Markdown to be able to understand all of it. For more detailed documents for beginners, see the &lt;a href="#other-resources-of-r-markdown">last section&lt;/a> of this post.&lt;a href="#fnref1">↩&lt;/a>&lt;/p>&lt;/li>
&lt;/ol>
&lt;/div>
&lt;p style="text-align:right;font-size:7px;margin-top:0px;margin-bottom:0px;padding-top:0px;padding-bottom:1px">
&lt;a href="https://www.r-bloggers.com/">Visit R-bloggers&lt;/a>&lt;br>
Last updated: 2018-12-01
&lt;/p></description><category>R Markdown</category><category>R-bloggers</category></item></channel></rss>